"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[188],{5723:function(e,t,r){var n=r(7437),a=r(2265),i=r(718),s=r.n(i),o=r(3082),l=r(2079),h=r(5476);let M={TRUE_WIND:1,APP_WIND:1},u=e=>{let{position:t=[0,0,0],rotation:r=[0,0,0],speed:a,color:i="#ffffff",fontSize:s=.5,textPosition:o=[0,.8,0],arrowSize:M=1}=e;return(0,n.jsxs)("group",{position:t,rotation:r,children:[(0,n.jsx)(h.x,{characters:".0123456789",color:i,fontSize:s*M,position:o,font:"fonts/Roboto-Bold.ttf",children:a.toFixed(1)}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("shapeGeometry",{args:[new l.bnF([new l.FM8(0,0),new l.FM8(.5*M*Math.cos(5*Math.PI/6),.5*M*Math.sin(5*Math.PI/6)),new l.FM8(0,-.577*M),new l.FM8(-.5*M*Math.cos(5*Math.PI/6),.5*M*Math.sin(5*Math.PI/6)),new l.FM8(0,0)])]}),(0,n.jsx)("meshStandardMaterial",{color:i,side:l.ehD})]})]})};u.propTypes={position:s().instanceOf(l.Pa4).isRequired,rotation:s().arrayOf(s().number).isRequired,speed:s().number.isRequired,color:s().string.isRequired,fontSize:s().number.isRequired,textPosition:s().arrayOf(s().number).isRequired};let T=e=>{let{outerRadius:t}=e,{getSignalKValue:r}=(0,o.yC)(),i=Math.PI/2-r("environment.wind.angleTrueGround")||0,s=(0,o.HQ)(r("environment.wind.speedOverGround"))||0,h=Math.PI/2-r("environment.wind.angleApparent")||0,T=(0,o.HQ)(r("environment.wind.speedApparent"))||0,d=(0,a.useMemo)(()=>new l.Pa4((t+.7)*Math.cos(i),0,-(t+.7)*Math.sin(i)),[t,i]),c=(0,a.useMemo)(()=>new l.Pa4((t+.7)*Math.cos(h),0,-(t+.7)*Math.sin(h)),[t,h]);return(0,n.jsxs)("group",{children:[s>0&&(0,n.jsx)(u,{position:d,rotation:[-Math.PI/2,0,-(Math.PI/2-i)],speed:s,color:"blue",fontSize:M.TRUE_WIND}),T>0&&(0,n.jsx)(u,{position:c,rotation:[-Math.PI/2,0,-(Math.PI/2-h)],speed:T,color:o.gK,fontSize:M.APP_WIND})]})};T.propTypes={outerRadius:s().number.isRequired},t.Z=T},7188:function(e,t,r){r.r(t),r.d(t,{default:function(){return P}});var n=r(7437),a=r(2265),i=r(8328),s=r(4725),o=r(5903),l=r(5550),h=r(1909),M=r(3082),u=r(5723),T=r(2079);let d={MOBILE_TEMPLATE:{COLOR:"yellow",WIDTH_FACTOR:.8,LENGTH_FACTOR:2.5,MAX_LENGTH_MULTIPLIER:3.5,CURVATURE_SENSITIVITY:{RUDDER:1.5,WIND:.25,CURRENT:.3,LEEWAY:.15,DRIFT:.1}},NEUTRAL_TEMPLATE:{COLOR:"blue",WIDTH_FACTOR:.7,LENGTH_FACTOR:.9},ANTICOLLISION_TEMPLATE:{COLOR:"red",WIDTH_FACTOR:1.5,LENGTH_FACTOR:.8}};var c=e=>{let{rudderAngle:t=0,sog:r=5,boatWidth:i=2,windSpeed:s=0,windDirection:o=0,currentSpeed:l=0,currentDirection:h=0,leewayAngle:M=0,driftFactor:u=0,maxCurvePoints:c=50}=e,E=(0,a.useRef)(),f=(0,a.useRef)(),I=(0,a.useRef)(),p=(0,a.useCallback)(()=>{let e=e=>T.M8C.degToRad(e),t=e(o),r=e(M),n=Math.cos(t+r)*s*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.WIND,a=Math.sin(t+r)*s*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.WIND,i=e(h),c=Math.cos(i)*l*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.CURRENT,E=Math.sin(i)*l*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.CURRENT;return{x:(n+c)*(1+u*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.DRIFT),z:(a+E)*(1+u*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.DRIFT)}},[s,o,l,h,M,u]),R=(0,a.useCallback)(()=>{let e=i*d.MOBILE_TEMPLATE.MAX_LENGTH_MULTIPLIER,r=Math.min(2*i*d.MOBILE_TEMPLATE.LENGTH_FACTOR,e),n=[],a=1.5*p().x;if(.1>Math.abs(t)){let e=.5*a,t=Math.max(i/Math.tan(T.M8C.degToRad(5+Math.abs(e))),.5*i),s=r/t,o=new T.FM8(e>0?t:-t,0),l=e>0?Math.PI:0;for(let r=0;r<=c;r++){let a=l+r/c*(e>0?s:-s),i=o.x+t*Math.cos(a),h=o.y+t*Math.sin(a);n.push(new T.Pa4(i,0,h))}}else{let e=T.M8C.clamp(1.2*Math.abs(t)+a,0,85),s=i/Math.tan(T.M8C.degToRad(e*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.RUDDER)),o=T.M8C.clamp(r/s,0,1.25*Math.PI);if(t>0){let e=new T.FM8(s,0),t=Math.PI;for(let r=0;r<=c;r++){let a=r/c,i=T.M8C.lerp(t,t+o,a),l=e.x+s*Math.cos(i),h=e.y+s*Math.sin(i);n.push(new T.Pa4(l,0,h))}}else{let e=new T.FM8(-s,0);for(let t=0;t<=c;t++){let r=t/c,a=T.M8C.lerp(0,0-o,r),i=e.x+s*Math.cos(a),l=e.y+s*Math.sin(a);n.push(new T.Pa4(i,0,l))}}}let s=n.map((e,t)=>{let r;(r=0===t?n[1].clone().sub(e):e.clone().sub(n[t-1])).normalize();let a=new T.Pa4(-r.z,0,r.x),s=i/1.8;return{left:e.clone().add(a.multiplyScalar(s)),right:e.clone().sub(a.multiplyScalar(s))}});return[...s.map(e=>e.left),s[s.length-1].right,...s.reverse().map(e=>e.right)]},[i,t,c,p]),P=(0,a.useCallback)(e=>{if("MOBILE_TEMPLATE"===e)return R();let t=d[e],r=2*i*t.LENGTH_FACTOR,n=i*t.WIDTH_FACTOR,a=[],s=Math.floor(c/4);for(let e=0;e<=s;e++){let t=e/s;a.push(new T.Pa4(-n/2,0,-r*t))}a.push(new T.Pa4(n/2,0,-r));for(let e=s;e>=0;e--){let t=e/s;a.push(new T.Pa4(n/2,0,-r*t))}return a},[i,c,R]);return(0,a.useEffect)(()=>{E.current&&f.current&&I.current&&(E.current.geometry.setFromPoints(P("MOBILE_TEMPLATE")),f.current.geometry.setFromPoints(P("NEUTRAL_TEMPLATE")),I.current.geometry.setFromPoints(P("ANTICOLLISION_TEMPLATE")))},[P]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("line",{ref:E,children:[(0,n.jsx)("bufferGeometry",{}),(0,n.jsx)("lineBasicMaterial",{color:d.MOBILE_TEMPLATE.COLOR,linewidth:2})]}),(0,n.jsxs)("line",{ref:f,children:[(0,n.jsx)("bufferGeometry",{}),(0,n.jsx)("lineBasicMaterial",{color:d.NEUTRAL_TEMPLATE.COLOR,linewidth:2})]}),(0,n.jsxs)("line",{ref:I,children:[(0,n.jsx)("bufferGeometry",{}),(0,n.jsx)("lineBasicMaterial",{color:d.ANTICOLLISION_TEMPLATE.COLOR,linewidth:2})]})]})},E=r(718),f=r.n(E),I=r(5476);let p=e=>{let{position:t,rotation:r,speed:a,color:i="#ffffff",fontSize:s=.5,textPosition:o=[0,.8,0],arrowSize:l=1}=e;return(0,n.jsxs)("group",{position:t,rotation:r,children:[(0,n.jsx)(I.x,{characters:"0123456789.",color:i,fontSize:s*l,position:o,font:"fonts/Roboto-Bold.ttf",anchorX:"center",anchorY:"middle",children:a.toFixed(1)}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("shapeGeometry",{args:[new T.bnF([new T.FM8(0,0),new T.FM8(.5*l*Math.cos(5*Math.PI/6),.5*l*Math.sin(5*Math.PI/6)),new T.FM8(0,-.577*l),new T.FM8(-.5*l*Math.cos(5*Math.PI/6),.5*l*Math.sin(5*Math.PI/6)),new T.FM8(0,0)])]}),(0,n.jsx)("meshStandardMaterial",{color:i,side:T.ehD})]})]})};p.propTypes={position:f().arrayOf(f().number),rotation:f().arrayOf(f().number),speed:f().number.isRequired,color:f().string,fontSize:f().number,textPosition:f().arrayOf(f().number),arrowSize:f().number},p.defaultProps={position:[0,0,0],rotation:[0,0,0],color:"#ffffff",fontSize:.5,textPosition:[0,.8,0],arrowSize:1};let R=e=>{let{outerRadius:t}=e,{getSignalKValue:r}=(0,M.yC)(),i=r("environment.current")||{setTrue:0,drift:0},s=(0,a.useMemo)(()=>{let e=i.setTrue||0;return[(t+.7)*Math.cos(e),0,-(t+.7)*Math.sin(e)]},[t,i.setTrue]);return!i.drift||i.drift<=0?null:(0,n.jsx)("group",{children:(0,n.jsx)(p,{position:s,rotation:[-Math.PI/2,0,-(Math.PI/2-(i.setTrue||0))],speed:i.drift,color:M.FV,arrowSize:1.2})})};R.propTypes={outerRadius:f().number.isRequired};var P=()=>{let e=(0,a.useRef)(),{getSignalKValue:t}=(0,M.yC)(),r=t("steering.rudderAngle")||0,T=t("navigation.speedOverGround")||0,d=t("environment.wind.angleApparent")||0,E=(0,M.HQ)(t("environment.wind.speedApparent"))||0,f=t("environment.current")||{setTrue:0,drift:0};return(0,n.jsxs)(a.Suspense,{fallback:(0,n.jsx)(i.V,{center:!0,children:"Loading..."}),children:[(0,n.jsx)(s.c,{makeDefault:!0,fov:60,near:1,far:1e3,position:[0,1,10]}),(0,n.jsx)(o.z,{enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/4}),(0,n.jsx)(l.qA,{files:"./assets/ocearo_env.hdr",background:!1,intensity:.8}),(0,n.jsx)("ambientLight",{intensity:.6}),(0,n.jsx)("spotLight",{position:[15,30,20],intensity:1.8,angle:Math.PI/6,penumbra:.5,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":.5,"shadow-camera-far":50,"shadow-bias":-.0001}),(0,n.jsx)("directionalLight",{position:[-10,20,10],intensity:1.5,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":.5,"shadow-camera-far":50,"shadow-bias":-.0001,color:"#ffd1a6"}),(0,n.jsx)("pointLight",{position:[-10,10,-10],intensity:.7}),(0,n.jsxs)("group",{position:[0,-3,0],children:[(0,n.jsx)(h.Z,{position:[0,0,.7],scale:[.5,.5,.5],ref:e,showSail:!1}),(0,n.jsx)(u.Z,{outerRadius:5}),(0,n.jsx)(R,{outerRadius:5}),(0,n.jsx)("group",{position:[0,0,-5],children:(0,n.jsx)(c,{rudderAngle:r,sog:T,windSpeed:E,windDirection:d,currentSpeed:f.drift,currentDirection:f.setTrue,boatWidth:2,leewayAngle:Math.min(Math.sin(Math.abs(d*Math.PI/180))*E*.02,10),driftFactor:T<.1?0:Math.min(f.drift/T,1),maxCurvePoints:100})})]})]})}}}]);