"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[188],{95723:function(e,t,n){var r=n(57437),a=n(2265),i=n(40718),o=n.n(i),s=n(53082),l=n(72079),h=n(45476);let M={TRUE_WIND:1,APP_WIND:1},u=e=>{let{position:t=[0,0,0],rotation:n=[0,0,0],speed:a,color:i="#ffffff",fontSize:o=.5,textPosition:s=[0,.8,0],arrowSize:M=1}=e;return(0,r.jsxs)("group",{position:t,rotation:n,children:[(0,r.jsx)(h.x,{characters:".0123456789",color:i,fontSize:o*M,position:s,font:"fonts/Roboto-Bold.ttf",children:a.toFixed(1)}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("shapeGeometry",{args:[new l.bnF([new l.FM8(0,0),new l.FM8(.5*M*Math.cos(5*Math.PI/6),.5*M*Math.sin(5*Math.PI/6)),new l.FM8(0,-.577*M),new l.FM8(-.5*M*Math.cos(5*Math.PI/6),.5*M*Math.sin(5*Math.PI/6)),new l.FM8(0,0)])]}),(0,r.jsx)("meshStandardMaterial",{color:i,side:l.ehD})]})]})};u.propTypes={position:o().instanceOf(l.Pa4).isRequired,rotation:o().arrayOf(o().number).isRequired,speed:o().number.isRequired,color:o().string.isRequired,fontSize:o().number.isRequired,textPosition:o().arrayOf(o().number).isRequired};let T=e=>{let{outerRadius:t}=e,{getSignalKValue:n}=(0,s.yC)(),i=Math.PI/2-n("environment.wind.angleTrueGround")||0,o=(0,s.HQ)(n("environment.wind.speedOverGround"))||0,h=Math.PI/2-n("environment.wind.angleApparent")||0,T=(0,s.HQ)(n("environment.wind.speedApparent"))||0,d=(0,a.useMemo)(()=>new l.Pa4((t+.7)*Math.cos(i),0,-(t+.7)*Math.sin(i)),[t,i]),c=(0,a.useMemo)(()=>new l.Pa4((t+.7)*Math.cos(h),0,-(t+.7)*Math.sin(h)),[t,h]);return(0,r.jsxs)("group",{children:[o>0&&(0,r.jsx)(u,{position:d,rotation:[-Math.PI/2,0,-(Math.PI/2-i)],speed:o,color:"blue",fontSize:M.TRUE_WIND}),T>0&&(0,r.jsx)(u,{position:c,rotation:[-Math.PI/2,0,-(Math.PI/2-h)],speed:T,color:s.gK,fontSize:M.APP_WIND})]})};T.propTypes={outerRadius:o().number.isRequired},t.Z=T},97188:function(e,t,n){n.r(t),n.d(t,{default:function(){return P}});var r=n(57437),a=n(2265),i=n(68328),o=n(44725),s=n(85903),l=n(5550),h=n(11909),M=n(53082),u=n(95723),T=n(72079);let d={MOBILE_TEMPLATE:{COLOR:"yellow",WIDTH_FACTOR:.8,LENGTH_FACTOR:2.5,MAX_LENGTH_MULTIPLIER:3.5,CURVATURE_SENSITIVITY:{RUDDER:1.5,WIND:.25,CURRENT:.3,LEEWAY:.15,DRIFT:.1}},NEUTRAL_TEMPLATE:{COLOR:"blue",WIDTH_FACTOR:.7,LENGTH_FACTOR:.9},ANTICOLLISION_TEMPLATE:{COLOR:"red",WIDTH_FACTOR:1.5,LENGTH_FACTOR:.8}};var c=e=>{let{rudderAngle:t=0,sog:n=5,boatWidth:i=2,windSpeed:o=0,windDirection:s=0,currentSpeed:l=0,currentDirection:h=0,leewayAngle:M=0,driftFactor:u=0,maxCurvePoints:c=50}=e,E=(0,a.useRef)(),f=(0,a.useRef)(),I=(0,a.useRef)(),p=(0,a.useCallback)(()=>{let e=e=>T.M8C.degToRad(e),t=e(s),n=e(M),r=Math.cos(t+n)*o*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.WIND,a=Math.sin(t+n)*o*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.WIND,i=e(h),c=Math.cos(i)*l*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.CURRENT,E=Math.sin(i)*l*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.CURRENT;return{x:(r+c)*(1+u*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.DRIFT),z:(a+E)*(1+u*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.DRIFT)}},[o,s,l,h,M,u]),R=(0,a.useCallback)(()=>{let e=i*d.MOBILE_TEMPLATE.MAX_LENGTH_MULTIPLIER,n=Math.min(2*i*d.MOBILE_TEMPLATE.LENGTH_FACTOR,e),r=[],a=1.5*p().x;if(.1>Math.abs(t)){let e=.5*a,t=Math.max(i/Math.tan(T.M8C.degToRad(5+Math.abs(e))),.5*i),o=n/t,s=new T.FM8(e>0?t:-t,0),l=e>0?Math.PI:0;for(let n=0;n<=c;n++){let a=l+n/c*(e>0?o:-o),i=s.x+t*Math.cos(a),h=s.y+t*Math.sin(a);r.push(new T.Pa4(i,0,h))}}else{let e=T.M8C.clamp(1.2*Math.abs(t)+a,0,85),o=i/Math.tan(T.M8C.degToRad(e*d.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.RUDDER)),s=T.M8C.clamp(n/o,0,1.25*Math.PI);if(t>0){let e=new T.FM8(o,0),t=Math.PI;for(let n=0;n<=c;n++){let a=n/c,i=T.M8C.lerp(t,t+s,a),l=e.x+o*Math.cos(i),h=e.y+o*Math.sin(i);r.push(new T.Pa4(l,0,h))}}else{let e=new T.FM8(-o,0);for(let t=0;t<=c;t++){let n=t/c,a=T.M8C.lerp(0,0-s,n),i=e.x+o*Math.cos(a),l=e.y+o*Math.sin(a);r.push(new T.Pa4(i,0,l))}}}let o=r.map((e,t)=>{let n;(n=0===t?r[1].clone().sub(e):e.clone().sub(r[t-1])).normalize();let a=new T.Pa4(-n.z,0,n.x),o=i/1.8;return{left:e.clone().add(a.multiplyScalar(o)),right:e.clone().sub(a.multiplyScalar(o))}});return[...o.map(e=>e.left),o[o.length-1].right,...o.reverse().map(e=>e.right)]},[i,t,c,p]),P=(0,a.useCallback)(e=>{if("MOBILE_TEMPLATE"===e)return R();let t=d[e],n=2*i*t.LENGTH_FACTOR,r=i*t.WIDTH_FACTOR,a=[],o=Math.floor(c/4);for(let e=0;e<=o;e++){let t=e/o;a.push(new T.Pa4(-r/2,0,-n*t))}a.push(new T.Pa4(r/2,0,-n));for(let e=o;e>=0;e--){let t=e/o;a.push(new T.Pa4(r/2,0,-n*t))}return a},[i,c,R]);return(0,a.useEffect)(()=>{E.current&&f.current&&I.current&&(E.current.geometry.setFromPoints(P("MOBILE_TEMPLATE")),f.current.geometry.setFromPoints(P("NEUTRAL_TEMPLATE")),I.current.geometry.setFromPoints(P("ANTICOLLISION_TEMPLATE")))},[P]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("line",{ref:E,children:[(0,r.jsx)("bufferGeometry",{}),(0,r.jsx)("lineBasicMaterial",{color:d.MOBILE_TEMPLATE.COLOR,linewidth:2})]}),(0,r.jsxs)("line",{ref:f,children:[(0,r.jsx)("bufferGeometry",{}),(0,r.jsx)("lineBasicMaterial",{color:d.NEUTRAL_TEMPLATE.COLOR,linewidth:2})]}),(0,r.jsxs)("line",{ref:I,children:[(0,r.jsx)("bufferGeometry",{}),(0,r.jsx)("lineBasicMaterial",{color:d.ANTICOLLISION_TEMPLATE.COLOR,linewidth:2})]})]})},E=n(40718),f=n.n(E),I=n(45476);let p=e=>{let{position:t,rotation:n,speed:a,color:i="#ffffff",fontSize:o=.5,textPosition:s=[0,.8,0],arrowSize:l=1}=e;return(0,r.jsxs)("group",{position:t,rotation:n,children:[(0,r.jsx)(I.x,{characters:"0123456789.",color:i,fontSize:o*l,position:s,font:"fonts/Roboto-Bold.ttf",anchorX:"center",anchorY:"middle",children:a.toFixed(1)}),(0,r.jsxs)("mesh",{children:[(0,r.jsx)("shapeGeometry",{args:[new T.bnF([new T.FM8(0,0),new T.FM8(.5*l*Math.cos(5*Math.PI/6),.5*l*Math.sin(5*Math.PI/6)),new T.FM8(0,-.577*l),new T.FM8(-.5*l*Math.cos(5*Math.PI/6),.5*l*Math.sin(5*Math.PI/6)),new T.FM8(0,0)])]}),(0,r.jsx)("meshStandardMaterial",{color:i,side:T.ehD})]})]})};p.propTypes={position:f().arrayOf(f().number),rotation:f().arrayOf(f().number),speed:f().number.isRequired,color:f().string,fontSize:f().number,textPosition:f().arrayOf(f().number),arrowSize:f().number},p.defaultProps={position:[0,0,0],rotation:[0,0,0],color:"#ffffff",fontSize:.5,textPosition:[0,.8,0],arrowSize:1};let R=e=>{let{outerRadius:t}=e,{getSignalKValue:n}=(0,M.yC)(),i=n("environment.current")||{setTrue:0,drift:0},o=(0,a.useMemo)(()=>{let e=i.setTrue||0;return[(t+.7)*Math.cos(e),0,-(t+.7)*Math.sin(e)]},[t,i.setTrue]);return!i.drift||i.drift<=0?null:(0,r.jsx)("group",{children:(0,r.jsx)(p,{position:o,rotation:[-Math.PI/2,0,-(Math.PI/2-(i.setTrue||0))],speed:i.drift,color:M.FV,arrowSize:1.2})})};R.propTypes={outerRadius:f().number.isRequired};var P=e=>{let{onUpdateInfoPanel:t}=e,n=(0,a.useRef)(),{getSignalKValue:T}=(0,M.yC)(),d=T("steering.rudderAngle")||0,E=T("navigation.speedOverGround")||0,f=T("environment.wind.angleApparent")||0,I=(0,M.HQ)(T("environment.wind.speedApparent"))||0,p=T("environment.current")||{setTrue:0,drift:0};return(0,r.jsxs)(a.Suspense,{fallback:(0,r.jsx)(i.V,{center:!0,children:"Loading..."}),children:[(0,r.jsx)(o.c,{makeDefault:!0,fov:60,near:1,far:1e3,position:[0,1,10]}),(0,r.jsx)(s.z,{enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/4}),(0,r.jsx)(l.qA,{files:"./assets/ocearo_env.hdr",background:!1,intensity:.8}),(0,r.jsx)("ambientLight",{intensity:.6}),(0,r.jsx)("spotLight",{position:[15,30,20],intensity:1.8,angle:Math.PI/6,penumbra:.5,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":.5,"shadow-camera-far":50,"shadow-bias":-.0001}),(0,r.jsx)("directionalLight",{position:[-10,20,10],intensity:1.5,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":.5,"shadow-camera-far":50,"shadow-bias":-.0001,color:"#ffd1a6"}),(0,r.jsx)("pointLight",{position:[-10,10,-10],intensity:.7}),(0,r.jsxs)("group",{position:[0,-3,0],children:[(0,r.jsx)(h.Z,{position:[0,0,.7],scale:[.5,.5,.5],ref:n,showSail:!1,onUpdateInfoPanel:t}),(0,r.jsx)(u.Z,{outerRadius:5}),(0,r.jsx)(R,{outerRadius:5}),(0,r.jsx)("group",{position:[0,0,-5],children:(0,r.jsx)(c,{rudderAngle:d,sog:E,windSpeed:I,windDirection:f,currentSpeed:p.drift,currentDirection:p.setTrue,boatWidth:2,leewayAngle:Math.min(Math.sin(Math.abs(f*Math.PI/180))*I*.02,10),driftFactor:E<.1?0:Math.min(p.drift/E,1),maxCurvePoints:100})})]})]})}}}]);