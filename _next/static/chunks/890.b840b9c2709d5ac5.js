(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[890],{9927:function(e,n,t){var o={"./default/Scene.jsx":[2967,967],"./optimist/Scene.jsx":[6154,154],"./sailboat/Scene.jsx":[2274,274],"./ship/Scene.jsx":[5221,221],"./windsurf/Scene.jsx":[2975,975]};function r(e){if(!t.o(o,e))return Promise.resolve().then(function(){var n=Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n});var n=o[e],r=n[0];return t.e(n[1]).then(function(){return t(r)})}r.keys=function(){return Object.keys(o)},r.id=9927,e.exports=r},890:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return X}});var o=t(7437),r=t(2265),a=t(8328),i=t(4725),l=t(5903),s=t(5550),c=t(1909),u=t(8124),d=t(8345),h=t(2079),f=t(3082);let m=(0,d.g)({time:0,speed:1,scale:3,opacity:.5,color:new h.Ilk(7895160),foamColor:new h.Ilk(16777215),waterColor:new h.Ilk(26367),rainbowActive:0},"\n    varying vec2 vUv;\n    varying float vElevation;\n    \n    void main() {\n      vUv = uv;\n      \n      // Add subtle vertex displacement for a wavy effect.\n      float elevation = sin(position.x * 0.2 + position.y * 0.3) * 0.1;\n      vElevation = elevation;\n      vec3 newPosition = position + normal * elevation;\n      \n      gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);\n    }\n  ","\n    uniform float time;\n    uniform float speed;\n    uniform float scale;\n    uniform float opacity;\n    uniform vec3 color;\n    uniform vec3 foamColor;\n    uniform vec3 waterColor;\n    uniform float rainbowActive; // Controls whether the rainbow effect is applied.\n\n    varying vec2 vUv;\n    varying float vElevation;\n\n    // Standard noise functions.\n    vec4 permute(vec4 x) {\n      return mod(((x * 34.0) + 1.0) * x, 289.0);\n    }\n\n    vec2 fade(vec2 t) {\n      return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n    }\n\n    float cnoise(vec2 P) {\n      vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\n      vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\n      Pi = mod(Pi, 289.0);\n      vec4 ix = Pi.xzxz;\n      vec4 iy = Pi.yyww;\n      vec4 fx = Pf.xzxz;\n      vec4 fy = Pf.yyww;\n      vec4 i = permute(permute(ix) + iy);\n      vec4 gx = 2.0 * fract(i * 0.0243902439) - 1.0;\n      vec4 gy = abs(gx) - 0.5;\n      vec4 tx = floor(gx + 0.5);\n      gx = gx - tx;\n      vec2 g00 = vec2(gx.x, gy.x);\n      vec2 g10 = vec2(gx.y, gy.y);\n      vec2 g01 = vec2(gx.z, gy.z);\n      vec2 g11 = vec2(gx.w, gy.w);\n      vec4 norm = 1.79284291400159 - 0.85373472095314 *\n                  vec4(dot(g00, g00), dot(g10, g10), dot(g01, g01), dot(g11, g11));\n      g00 *= norm.x;\n      g10 *= norm.y;\n      g01 *= norm.z;\n      g11 *= norm.w;\n      float n00 = dot(g00, vec2(fx.x, fy.x));\n      float n10 = dot(g10, vec2(fx.y, fy.y));\n      float n01 = dot(g01, vec2(fx.z, fy.z));\n      float n11 = dot(g11, vec2(fx.w, fy.w));\n      vec2 fade_xy = fade(Pf.xy);\n      vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\n      float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n      return 2.3 * n_xy;\n    }\n\n    // HSL to RGB conversion function.\n    vec3 hsl2rgb(vec3 hsl) {\n      vec3 rgb = clamp(abs(mod(hsl.x * 6.0 + vec3(0.0, 4.0, 2.0), 6.0) - 3.0) - 1.0,\n                       0.0, 1.0);\n      rgb = rgb * rgb * (3.0 - 2.0 * rgb);\n      return hsl.z + hsl.y * (rgb - 0.5) * (1.0 - abs(2.0 * hsl.z - 1.0));\n    }\n\n    void main() {\n      // Combine multiple layers of noise to build a complex water pattern.\n      float baseNoise = cnoise(vUv * scale + vec2(time * speed, 0.0));\n      float detailNoise = cnoise(vUv * scale * 2.0 + vec2(time * speed * 1.5, 0.0)) * 0.5;\n      float turbulence = cnoise(vUv * scale * 4.0 + vec2(time * speed * 2.0, 0.0)) * 0.25;\n      float noise = baseNoise + detailNoise + turbulence;\n      \n      // Create a wake pattern.\n      float wake = smoothstep(0.3, 0.7, 1.0 - abs(vUv.x - 0.5) * 2.0);\n      \n      // Create a foam effect.\n      float foam = smoothstep(0.4, 0.6, noise + wake);\n      \n      // Mix water and foam colors, then blend in the base color.\n      vec3 finalColor = mix(waterColor, foamColor, foam);\n      finalColor = mix(finalColor, color, wake * 0.5);\n      \n      // Adjust dynamic opacity.\n      float alpha = opacity * (wake + foam * 0.5) * (1.0 - vUv.y);\n      \n      // Add wave highlights.\n      float highlight = smoothstep(0.2, 0.4, noise + wake) *\n                        (1.0 - smoothstep(0.4, 0.6, noise + wake));\n      finalColor += highlight * foamColor * 0.5;\n      \n      // --- Rainbow Effect ---\n      // When rainbowActive is enabled, overlay a dynamic rainbow gradient.\n      if (rainbowActive > 0.5) {\n        // Cycle the hue based on the horizontal UV and time.\n        float rainbowHue = mod(vUv.x + time * 0.5, 1.0);\n        vec3 rainbowColor = hsl2rgb(vec3(rainbowHue, 1.0, 0.5));\n        // Blend the rainbow with the original finalColor.\n        finalColor = mix(finalColor, rainbowColor, 0.7);\n      }\n      \n      gl_FragColor = vec4(finalColor, alpha);\n    }\n  ");(0,u.e)({TrailShaderMaterial:m});let g=e=>{let{color:n="#787878",waterColor:t="#0066ff",foamColor:a="#ffffff",speed:i=1,scale:l=3,opacity:s=.5}=e,c=(0,r.useRef)(),{getSignalKValue:d}=(0,f.yC)();return(0,u.F)((e,n)=>{if(c.current){c.current.uniforms.time.value+=n;let e=d("steering.autopilot.state")||!1;c.current.uniforms.rainbowActive.value=e?1:0}}),(0,o.jsxs)("mesh",{rotation:[-Math.PI/2,0,Math.PI/2],position:[0,0,22.5],children:[(0,o.jsx)("planeGeometry",{args:[40,2.2,128,32]}),(0,o.jsx)("trailShaderMaterial",{ref:c,color:new h.Ilk(n),waterColor:new h.Ilk(t),foamColor:new h.Ilk(a),speed:i,scale:l,opacity:s,transparent:!0,depthWrite:!1,blending:h.WMw})]})};var v=t(4752);(0,u.e)({Water:v.B});var p=function(){let e=(0,r.useRef)(),n=(0,u.D)(e=>e.gl),t=(0,u.D)(e=>e.scene),a=(0,u.H)(h.dpR,"assets/waternormals.jpg");(0,r.useMemo)(()=>{a.wrapS=a.wrapT=h.rpg},[a]);let i=(0,r.useMemo)(()=>new h._12(1e4,1e4),[]),l=(0,r.useMemo)(()=>({textureWidth:600,textureHeight:450,waterNormals:a,sunDirection:new h.Pa4(0,1,0),sunColor:16777215,waterColor:30654,distortionScale:5,format:n.encoding,reflectivity:0}),[a,n.encoding]);(0,r.useMemo)(()=>{t.environment=null,t.background=null},[t]);let s=0;return(0,u.F)((n,t)=>{(s+=t)>.05&&(e.current&&(e.current.material.uniforms.time.value+=s),s=0)}),(0,o.jsx)("water",{ref:e,args:[i,l],"rotation-x":-Math.PI/2,position:[0,-.1,0]})},x=t(4578),w=t(3321);let M=(0,r.createContext)(),y=()=>(0,r.useContext)(M),b=(e,n,t,o)=>{let r=t.split(".").reduce((e,n)=>null==e?void 0:e[n],o);void 0!==r&&(e[n]=r)},j=e=>{let{children:n}=e,[t,a]=(0,r.useState)({}),[i,l]=(0,r.useState)([]),s=(0,r.useRef)(null);return(0,r.useEffect)(()=>{let e=async e=>{console.log("Fetching static vessel information...");try{let n=await e.API().then(e=>e.vessels()),t=Object.entries(n).map(e=>{let[n,t]=e,o={mmsi:n};return b(o,"name","name",t),b(o,"latitude","navigation.position.value.latitude",t),b(o,"longitude","navigation.position.value.longitude",t),b(o,"cog","navigation.courseOverGroundTrue.value",t),b(o,"heading","navigation.headingTrue.value",t),b(o,"length","design.length.value.overall",t),b(o,"beam","design.beam.value",t),b(o,"callsign","communication.callsignVhf",t),b(o,"shipType","design.aisShipType.value.id",t),o});console.log("Fetched ".concat(t.length," vessels.")),l(t)}catch(e){console.error("Error fetching static vessel info:",e)}},n=e=>{if(!(null==e?void 0:e.updates)){console.warn("Delta is missing or does not contain updates:",e);return}let n=e=>({mmsi:e,name:"unknown",latitude:null,longitude:null,sog:null,cog:null,heading:null}),t=e.context.replace("vessels.","");if(!t){console.warn("Update missing MMSI context:",e);return}a(o=>{let r=o[t]||n(t);return e.updates.forEach(e=>{e.values.forEach(e=>{switch(e.path){case"name":r.name=e.value;break;case"navigation.position":r.latitude=e.value.latitude,r.longitude=e.value.longitude;break;case"navigation.speedOverGround":r.sog=e.value;break;case"navigation.courseOverGroundTrue":r.cog=e.value;break;case"navigation.headingTrue":r.heading=e.value}})}),{...o,[t]:r}})};return(async()=>{try{let{signalkUrl:t}=w.Z.getAll();if(console.log("SignalK URL:",t),!t)throw Error("SignalK URL is undefined or invalid.");let[o,r]=t.replace(/https?:\/\//,"").split(":");console.log("Connecting to SignalK at hostname: ".concat(o,", port: ").concat(r));let a=new x.default({hostname:o||"localhost",port:parseInt(r)||3e3,useTLS:t.startsWith("https"),reconnect:!0,autoConnect:!1,notifications:!1,subscriptions:[{context:"vessels.*",subscribe:[{path:"navigation.position"},{path:"navigation.speedOverGround"},{path:"navigation.courseOverGroundTrue"},{path:"navigation.headingTrue"}]}]});s.current=a,await a.connect(),console.log("SignalK client connected."),await e(a),a.on("delta",n)}catch(e){console.error("Error connecting to SignalK:",e)}})(),()=>{var e;console.log("Disconnecting SignalK client..."),null===(e=s.current)||void 0===e||e.disconnect()}},[]),(0,o.jsx)(M.Provider,{value:{aisData:t,vesselIds:i},children:n})};var C=t(5476);let P=async e=>{try{let n=await t(9927)("./".concat(e,"/Scene.jsx"));return n.default?n.default:n.Model}catch(n){throw console.error("Error loading ".concat(e," component:"),n),n}},R=e=>0===e?"windsurf":30===e?"optimist":36===e?"sailboat":"ship",S=(0,r.forwardRef)((e,n)=>{let{position:t,visible:a,boatData:i}=e,[l,s]=(0,r.useState)(null),c=R(i.shipType);if((0,r.useEffect)(()=>{let e=!0;return P(c).then(n=>{e&&s(()=>n)}).catch(e=>console.error("Failed to load ".concat(c,":"),e)),()=>{e=!1}},[c]),!l)return null;let u=(e,n)=>"".concat(e,": ").concat(n||"N/A","\n"),d=[u("Name",i.name||"Unknown"),u("Length",i.length?"".concat(i.length,"m"):"N/A"),u("Type",i.shipType)].join(""),h=(i.length||10)/10;return(0,o.jsxs)("group",{ref:n,position:t,visible:a,children:[(0,o.jsx)(l,{scale:[h,h,h]}),(0,o.jsx)(C.x,{position:[3,9,0],fontSize:.5,maxWidth:3,lineHeight:1,textAlign:"left",color:"white",anchorX:"center",anchorY:"top",font:"fonts/Roboto-Bold.ttf",children:d})]})});S.displayName="AISBoat";let I=e=>{if(e.material)return e;for(let n of e.children){let e=I(n);if(e)return e}return null},E=(e,n,t,o)=>({x:Math.PI/180*(n-o)*6371e3*Math.cos(Math.PI/180*t),y:Math.PI/180*(e-t)*6371e3}),T=(e,n)=>{if(null!=e.sog&&null!=e.cog){let t=.51444*e.sog;return{deltaX:t*n*Math.sin(e.cog*Math.PI/180)*.7,deltaY:t*n*Math.cos(e.cog*Math.PI/180)*.7}}return{deltaX:0,deltaY:0}},_=function(e,n,t){let o=!(arguments.length>3)||void 0===arguments[3]||arguments[3],r=-(.7*n),a=.7*t;o?(e.position.x+=(r-e.position.x)*.1,e.position.z+=(a-e.position.z)*.1):e.position.set(r,0,a)},O=function(e,n){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],o=n*Math.PI/180;t?e.children[0].rotation.y+=(o-e.children[0].rotation.y)*.1:e.children[0].rotation.y=o};var k=()=>{let{aisData:e,vesselIds:n}=y(),t=(0,r.useRef)({}),{getSignalKValue:a}=(0,f.yC)();(0,u.F)(()=>{let o=a("navigation.position"),r=a("navigation.speedOverGround");if(!(null==o?void 0:o.latitude)||!(null==o?void 0:o.longitude)||!Object.keys(t.current).length)return;let i=performance.now(),l=n.length&&!Object.keys(e).length;Object.values(l?n:e).forEach(e=>{if(null==e.latitude||null==e.longitude||!t.current[e.mmsi])return;let n=t.current[e.mmsi],a=e.lastUpdate||i,{x:s,y:c}=E(e.latitude,e.longitude,o.latitude,o.longitude),u=0,d=0;!l&&null!=r&&r>0&&i-a>1e3&&({deltaX:u,deltaY:d}=T(e,(i-a)/1e3));let h=s+u,f=c+d,m=Math.sqrt((.7*h)**2+(.7*f)**2);if(m>0&&m<=2100){n.visible=!0,n.currentColor||(n.currentColor=m<350?"red":"white");let t=n.currentColor;"red"===n.currentColor&&m>385?t="white":"white"===n.currentColor&&m<350&&(t="red"),_(n,h,f,!l),null!=e.cog?O(n,e.cog,!l):null!=e.heading&&O(n,e.heading,!l);let o=I(n.children[0]);o?(n.redMaterial||(n.redMaterial=o.material.clone(),n.redMaterial.color.set("red")),n.whiteMaterial||(n.whiteMaterial=o.material.clone(),n.whiteMaterial.color.set("white")),"red"===t&&"red"!==n.currentMaterial?(o.material=n.redMaterial,n.currentMaterial="red",console.log("Swapped material to red for boat ".concat(e.mmsi))):"white"===t&&"white"!==n.currentMaterial&&(o.material=n.whiteMaterial,n.currentMaterial="white",console.log("Swapped material to white for boat ".concat(e.mmsi))),n.currentColor=t):console.warn("Material not found for boat ".concat(e.mmsi))}else n.visible=!1})});let i=(0,r.useMemo)(()=>n.filter(e=>e.mmsi&&!e.mmsi.startsWith("urn:mrn:signalk:uuid:")&&!e.mmsi.startsWith("227925790")&&!e.mmsi.startsWith("urn:mrn:imo:mmsi:230035780")).map(e=>(0,o.jsx)(S,{ref:n=>t.current[e.mmsi]=n,position:[0,0,0],visible:!1,boatData:e},e.mmsi)),[n]);return(0,o.jsx)(o.Fragment,{children:i})},N=t(1);let A=r.memo(e=>{let{radius:n,isOuter:t,markerColorPrimary:a,markerColorGreen:i,markerColorRed:l}=e,s=(0,r.useMemo)(()=>{let e=[];for(let r=0;r<360;r+=10){let s=h.M8C.degToRad(r-90),c=r%30==0,u=t?c?.4:.2:c?.3:.15,d=(n+.5*u+.2)*Math.cos(s),f=(n+.5*u+.2)*Math.sin(s),m=t&&r>0&&r<61,g=t&&r>=300&&r<360,v=m?i:g?l:a;if(!t&&c){let n=0===r?"N":r.toString();e.push((0,o.jsx)(C.x,{characters:"N0123456789",position:[d,.01,f],color:a,fontSize:.5,rotation:[-Math.PI/2,0,Math.PI/2-s],font:"fonts/Roboto-Bold.ttf",anchorY:"middle",children:n},"text-".concat(r)))}else e.push((0,o.jsx)(N.aL,{args:[u/2,16,16],position:[d,0,f],children:(0,o.jsx)("meshBasicMaterial",{color:v})},"marker-".concat(t?"outer":"inner","-").concat(r)))}return e},[n,t,a,i,l]);return(0,o.jsx)(o.Fragment,{children:s})});A.displayName="StaticMarkers";let F=r.memo(e=>{let{innerRadius:n,outerRadius:t,dialColor:r,opacity:a=1,transparent:i=!1}=e;return(0,o.jsx)(N.FM,{args:[n,t,64],rotation:[Math.PI/2,0,0],children:(0,o.jsx)("meshBasicMaterial",{color:r,side:h.ehD,transparent:i,opacity:a})})});F.displayName="StaticRing";let G=e=>{let{outerRadius:n,innerRadius:t}=e,a=f.FV,i=f.HH,{nightMode:l,getSignalKValue:s}=(0,f.yC)(),c=l?f.eF:16777215,u=s("navigation.courseOverGroundTrue")||s("navigation.headingTrue"),d=(0,r.useMemo)(()=>({innerRadius:t,outerRadius:n,dialColor:c,markerColorPrimary:0,markerColorGreen:a,markerColorRed:i}),[t,n,c,0,a,i]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("group",{rotation:[0,Math.PI-u,0],children:[(0,o.jsx)(F,{innerRadius:d.innerRadius,outerRadius:d.outerRadius,dialColor:d.dialColor}),(0,o.jsx)(A,{radius:d.innerRadius,isOuter:!1,markerColorPrimary:d.markerColorPrimary,markerColorGreen:d.markerColorGreen,markerColorRed:d.markerColorRed})]}),(0,o.jsxs)("group",{children:[(0,o.jsx)(F,{innerRadius:d.innerRadius+1,outerRadius:d.outerRadius+1,dialColor:d.dialColor,transparent:!0,opacity:.5}),(0,o.jsx)(A,{radius:d.innerRadius+1,isOuter:!0,markerColorPrimary:d.markerColorPrimary,markerColorGreen:d.markerColorGreen,markerColorRed:d.markerColorRed})]})]})};G.displayName="CompassDial";var U=t(5723),D=()=>(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(G,{outerRadius:5.6,innerRadius:5}),(0,o.jsx)(U.Z,{outerRadius:5.6+1.1})]}),L=t(8181),z=JSON.parse('{"N":{"52":[4.98,5.86,6.31,6.45,6.51,6.52,6.41],"60":[5.25,6.11,6.56,6.73,6.79,6.82,6.79],"75":[5.45,6.33,6.77,7.01,7.13,7.2,7.24],"90":[5.66,6.55,7,7.25,7.38,7.53,7.7],"110":[5.49,6.49,7.04,7.4,7.69,7.97,8.38],"120":[5.32,6.36,6.97,7.39,7.77,8.1,8.6],"135":[4.81,5.92,6.68,7.15,7.55,7.95,8.85],"150":[4.09,5.17,6.04,6.61,6.99,7.31,7.93],"angles":[52,60,75,90,110,120,135,150],"speeds":[6,8,10,12,14,16,20],"beat_angle":[43.6,42,41.2,41.2,41.7,42.1,44.2],"beat_vmg":[3.26,3.91,4.24,4.34,4.36,4.34,4.16],"run_angle":[144.8,147.8,148.5,149.6,171.8,175.4,177.2],"run_vmg":[3.54,4.48,5.23,5.73,6.17,6.67,7.36]}}');let H={DEG2RAD:Math.PI/180,ROTATION_INTERPOLATION_FACTOR:.05,SOG_SMOOTHING_FACTOR:.1,DEFAULT_SOG:3,ANGLE_INCREMENT:10,SPHERE_SIZE:.4,SPHERE_SEGMENTS:32,DEFAULT_LINE_WIDTH:1,PLOTS_COUNT:5,FRAME_TO_MINUTE_RATIO:3600},W=(e,n)=>26.8224*e*n*.1,q=(e,n,t)=>{if(!e||!n)return new h.Pa4(0,0,0);let o=e*H.DEG2RAD,r=W(n,t);return new h.Pa4(r*Math.sin(o),0,-r*Math.cos(o))},B=(e,n)=>{if(!(null==e?void 0:e.length))return 0;let t=0,o=e.length-1;for(;t<o;){let r=Math.floor((t+o)/2);e[r]<n?t=r+1:o=r}return t},K=e=>{let{position:n,color:t}=e;return n?(0,o.jsxs)("mesh",{position:n,children:[(0,o.jsx)("sphereGeometry",{args:[H.SPHERE_SIZE,H.SPHERE_SEGMENTS,H.SPHERE_SEGMENTS]}),(0,o.jsx)("meshStandardMaterial",{color:t})]}):null},Z=e=>{let{points:n,color:t}=e;return(null==n?void 0:n.length)?(0,o.jsx)(L.x,{points:n,color:t,lineWidth:H.DEFAULT_LINE_WIDTH}):null},V=r.memo(e=>{let{timeInMinute:n,windSpeed:t}=e,a=(0,r.useRef)(z.N),i=(0,r.useCallback)((e,n,t,o)=>(null==e?void 0:e.length)&&(null==n?void 0:n.length)&&!(e.length<=t)&&!(n.length<=t)?q(e[t],n[t],o):(console.warn("Invalid angle or VMG data"),null),[]),l=(0,r.useCallback)((e,n)=>{let{speeds:t,angles:o,beat_angle:r,beat_vmg:i,run_angle:l,run_vmg:s}=a.current;if(!(null==t?void 0:t.length)||!(null==o?void 0:o.length))return console.warn("Invalid polar data"),null;let c=(e,n,t)=>e+t*(n-e),u=[],d=(e,t,o)=>{for(let r=e;r<=t;r+=H.ANGLE_INCREMENT)u.push(q(r,o(r),n))};return d(0,r[e],n=>c(0,i[e],n/r[e])),o.forEach(t=>{if(t>r[e]&&t<l[e]){var o;let r=(null===(o=a.current[Math.floor(t)])||void 0===o?void 0:o[e])||0;u.push(q(t,r,n))}}),d(l[e],180,()=>s[e]),new h.YT8(u,!0)},[]),s=(0,r.useMemo)(()=>{var e;let o=a.current;if(!(null==o?void 0:null===(e=o.speeds)||void 0===e?void 0:e.length))return console.warn("Invalid polar data structure"),{curve:null,beat:null,run:null};let r=B(o.speeds,t);return{curve:l(r,n),beat:i(o.beat_angle,o.beat_vmg,r,n),run:i(o.run_angle,o.run_vmg,r,n)}},[n,t,i,l]);return(0,o.jsx)(o.Fragment,{children:[0,-Math.PI].map((e,n)=>(0,o.jsxs)("group",{position:[0,-.7,0],rotation:[0,0,e],children:[s.curve&&(0,o.jsx)(Z,{points:s.curve.getPoints(100),color:f.gK}),(0,o.jsx)(K,{position:s.beat,color:f.FV}),(0,o.jsx)(K,{position:s.run,color:f.HH})]},n))})});V.displayName="PolarPlot";var Y=function(){let e=(0,r.useRef)([]),[n,t]=(0,r.useState)([]),a=(0,r.useRef)(0),i=(0,r.useRef)([]),l=(0,r.useRef)(H.DEFAULT_SOG),{getSignalKValue:s}=(0,f.yC)(),c=-s("environment.wind.angleApparent"),d=(0,f.HQ)(s("environment.wind.speedOverGround"))||0,m=s("navigation.speedOverGround")||H.DEFAULT_SOG;return(0,r.useEffect)(()=>{let n=Array.from({length:H.PLOTS_COUNT},(e,n)=>({id:n,timeInMinute:5*(n+1)}));t(n),e.current=n.map(()=>new h.ZAu),i.current=Array(H.PLOTS_COUNT).fill(0)},[]),(0,u.F)((t,o)=>{a.current+=1,l.current=h.M8C.lerp(l.current,m,H.SOG_SMOOTHING_FACTOR),n.forEach((n,t)=>{let o=e.current[t];if(o&&n.timeInMinute-a.current/H.FRAME_TO_MINUTE_RATIO>0){let e=i.current[t],n=h.M8C.lerp(e,c,H.ROTATION_INTERPOLATION_FACTOR);o.rotation.set(0,n,0),i.current[t]=n}})}),(0,o.jsx)(o.Fragment,{children:n.map((n,t)=>(0,o.jsx)("group",{ref:n=>{n&&(e.current[t]=n)},children:(0,o.jsx)(V,{timeInMinute:n.timeInMinute,windSpeed:d})},n.id))})},Q=()=>{let{states:e,nightMode:n}=(0,f.yC)(),t=n?.2:.4;return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("ambientLight",{intensity:n?.3:.5}),(0,o.jsx)("directionalLight",{position:[0,50,0],intensity:n?.8:1.4,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":.5,"shadow-camera-far":100,"shadow-camera-left":-20,"shadow-camera-right":20,"shadow-camera-top":20,"shadow-camera-bottom":-20,"shadow-bias":-.0001,color:n?"#c8e6ff":"#ffffff"}),(0,o.jsx)("directionalLight",{position:[0,40,5],intensity:t,castShadow:!1}),(0,o.jsx)("pointLight",{position:[0,30,0],intensity:1.5*t,distance:60,decay:2})]})},X=()=>{let{states:e}=(0,f.yC)(),n=(0,r.useRef)();return(0,o.jsxs)(r.Suspense,{fallback:(0,o.jsx)(a.V,{children:"Loading..."}),children:[(0,o.jsx)(i.c,{makeDefault:!0,fov:60,near:1,far:1e3,position:[0,5,20]}),(0,o.jsx)(l.z,{enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/4}),(0,o.jsx)(s.qA,{files:"./assets/ocearo_env.hdr",background:!1,intensity:.8}),(0,o.jsx)(Q,{}),(0,o.jsxs)("group",{position:[0,-3,0],children:[(0,o.jsx)(c.Z,{position:[0,0,.7],scale:[.7,.7,.7],ref:n,showSail:!0}),e.showOcean&&(0,o.jsx)(p,{}),(0,o.jsx)(g,{}),e.showPolar&&(0,o.jsx)(Y,{}),e.ais&&(0,o.jsx)(j,{children:(0,o.jsx)(k,{})}),(0,o.jsx)(D,{visible:!1})]})]})}},5723:function(e,n,t){"use strict";var o=t(7437),r=t(2265),a=t(718),i=t.n(a),l=t(3082),s=t(2079),c=t(5476);let u={TRUE_WIND:1,APP_WIND:1},d=e=>{let{position:n=[0,0,0],rotation:t=[0,0,0],speed:r,color:a="#ffffff",fontSize:i=.5,textPosition:l=[0,.8,0],arrowSize:u=1}=e;return(0,o.jsxs)("group",{position:n,rotation:t,children:[(0,o.jsx)(c.x,{characters:".0123456789",color:a,fontSize:i*u,position:l,font:"fonts/Roboto-Bold.ttf",children:r.toFixed(1)}),(0,o.jsxs)("mesh",{children:[(0,o.jsx)("shapeGeometry",{args:[new s.bnF([new s.FM8(0,0),new s.FM8(.5*u*Math.cos(5*Math.PI/6),.5*u*Math.sin(5*Math.PI/6)),new s.FM8(0,-.577*u),new s.FM8(-.5*u*Math.cos(5*Math.PI/6),.5*u*Math.sin(5*Math.PI/6)),new s.FM8(0,0)])]}),(0,o.jsx)("meshStandardMaterial",{color:a,side:s.ehD})]})]})};d.propTypes={position:i().instanceOf(s.Pa4).isRequired,rotation:i().arrayOf(i().number).isRequired,speed:i().number.isRequired,color:i().string.isRequired,fontSize:i().number.isRequired,textPosition:i().arrayOf(i().number).isRequired};let h=e=>{let{outerRadius:n}=e,{getSignalKValue:t}=(0,l.yC)(),a=Math.PI/2-t("environment.wind.angleTrueGround")||0,i=(0,l.HQ)(t("environment.wind.speedOverGround"))||0,c=Math.PI/2-t("environment.wind.angleApparent")||0,h=(0,l.HQ)(t("environment.wind.speedApparent"))||0,f=(0,r.useMemo)(()=>new s.Pa4((n+.7)*Math.cos(a),0,-(n+.7)*Math.sin(a)),[n,a]),m=(0,r.useMemo)(()=>new s.Pa4((n+.7)*Math.cos(c),0,-(n+.7)*Math.sin(c)),[n,c]);return(0,o.jsxs)("group",{children:[i>0&&(0,o.jsx)(d,{position:f,rotation:[-Math.PI/2,0,-(Math.PI/2-a)],speed:i,color:"blue",fontSize:u.TRUE_WIND}),h>0&&(0,o.jsx)(d,{position:m,rotation:[-Math.PI/2,0,-(Math.PI/2-c)],speed:h,color:l.gK,fontSize:u.APP_WIND})]})};h.propTypes={outerRadius:i().number.isRequired},n.Z=h}}]);