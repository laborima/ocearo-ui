(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{9927:function(e,t,a){var n={"./default/Scene.jsx":[2967,967],"./optimist/Scene.jsx":[6154,154],"./sailboat/Scene.jsx":[2274,274],"./ship/Scene.jsx":[5221,221],"./windsurf/Scene.jsx":[2975,975]};function i(e){if(!a.o(n,e))return Promise.resolve().then(function(){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t});var t=n[e],i=t[0];return a.e(t[1]).then(function(){return a(i)})}i.keys=function(){return Object.keys(n)},i.id=9927,e.exports=i},7343:function(e,t,a){Promise.resolve().then(a.bind(a,9898))},9898:function(e,t,a){"use strict";a.r(t),a.d(t,{VIEW_MODES:function(){return tm},default:function(){return tx}});var n=a(7437),i=a(2265),r=a(376),l=a.n(r),o=e=>{let{path:t}=e,[a,r]=(0,i.useState)([]),[l,o]=(0,i.useState)(null),s=(0,i.useRef)(null);return(0,i.useEffect)(()=>{(async()=>{try{let e=await fetch("".concat(t,"/index.json"));if(!e.ok)throw Error("Network response was not ok");let a=await e.json();r(a),a.length>0&&o(a[0])}catch(e){console.error("Error fetching PDF files:",e)}})()},[t]),(0,n.jsxs)("div",{className:"flex flex-col h-full",ref:s,children:[(0,n.jsx)("div",{className:"bg-oGray2 text-white p-4 flex space-x-4",children:a.map((e,t)=>(0,n.jsx)("button",{className:"px-4 py-2 rounded-t ".concat((null==l?void 0:l.file)===e.file?"bg-oGray font-bold":"hover:bg-oGray"),onClick:()=>o(e),children:e.title},t))}),(0,n.jsx)("div",{className:"flex-grow bg-oGray2 text-white p-4 flex items-center justify-center",children:l&&(0,n.jsx)("iframe",{src:"".concat(t,"/").concat(l.file),title:"PDF Viewer",width:"100%",height:"100%",style:{border:"none"}})})]})},s=JSON.parse('{"F":[{"name":"Default","modelPath":"default","capabilities":["navigation","rudder","sail","color"]},{"name":"Optimist","modelPath":"optimist","capabilities":["navigation","ais"]},{"name":"Sailboat","modelPath":"sailboat","capabilities":["navigation","ais"]},{"name":"Ship","modelPath":"ship","capabilities":["navigation","ais"]},{"name":"Windsurf","modelPath":"windsurf","capabilities":["navigation","ais"]}]}');class c{isLocalStorageAvailable(){try{return"undefined"!=typeof localStorage}catch(e){return!1}}loadConfig(){if(this.isLocalStorageAvailable()){let e=localStorage.getItem(this.configKey);if(!e)return this.saveConfig(this.defaultConfig),{...this.defaultConfig};try{return JSON.parse(e)}catch(e){return console.error("Failed to parse stored configuration:",e),{...this.defaultConfig}}}return{...this.inMemoryConfig}}saveConfig(e){this.config={...this.config,...e},this.isLocalStorageAvailable()?localStorage.setItem(this.configKey,JSON.stringify(this.config)):this.inMemoryConfig={...this.config}}get(e){return this.config[e]}set(e,t){this.config[e]=t,this.saveConfig(this.config)}resetConfig(){this.config={...this.defaultConfig},this.isLocalStorageAvailable()?localStorage.setItem(this.configKey,JSON.stringify(this.config)):this.inMemoryConfig={...this.defaultConfig}}getAll(){return{...this.config}}getDefaultConfig(){return{...this.defaultConfig}}getSelectedBoat(){let e=this.config.selectedBoat;return e?this.getBoatsData().find(t=>t.name===e):[]}getBoatsData(){return s.F}getComputedSignalKUrl(){return this.config.debugMode?"https://demo.signalk.org:443":"".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.port?":"+window.location.port:"")}constructor(){this.defaultConfig={signalkUrl:"https://demo.signalk.org:443",username:"",password:"",debugMode:!1,selectedBoat:"Default",primaryColor:null,metallicEffect:!1},this.configKey="ocearoConfig",this.inMemoryConfig={...this.defaultConfig},this.config=this.loadConfig()}}let d=new c;var u=e=>{var t;let{onSave:a}=e,r=d.getAll(),l=d.getComputedSignalKUrl(),o=d.getBoatsData(),[s,c]=(0,i.useState)(r),[u,h]=(0,i.useState)(!!r.username||!!r.password),[m,g]=(0,i.useState)(!1),[x,f]=(0,i.useState)(null),[p,v]=(0,i.useState)(!1),b=(0,i.useCallback)(e=>{v(JSON.stringify(e)!==JSON.stringify(r))},[r]);(0,i.useEffect)(()=>{(async()=>{let e=d.getAll();c(e),e.selectedBoat&&f(o.find(t=>t.name===e.selectedBoat)||null)})()},[o]);let j=e=>{let t={...s,...e};c(t),b(t)},w=()=>{let e={...s};m?u||(e.username="",e.password=""):(e.signalkUrl=l,e.username="",e.password=""),d.saveConfig(e),null==a||a(e),v(!1)};return(0,n.jsxs)("div",{className:"p-4 text-white",children:[p&&(0,n.jsxs)("div",{className:"bg-oBlue text-white px-4 py-2 rounded mb-4 flex justify-between items-center",children:[(0,n.jsx)("span",{children:"You have unsaved changes"}),(0,n.jsx)("button",{onClick:w,className:"bg-white text-black px-3 py-1 rounded text-sm hover:bg-gray-100",children:"Save Now"})]}),(0,n.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Ocearo Configuration"}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Connection Settings"}),(0,n.jsx)("div",{children:(0,n.jsxs)("label",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",className:"mr-2",checked:m,onChange:e=>{g(e.target.checked),b(s)}}),"Set SignalK URL",!m&&(0,n.jsxs)("span",{className:"ml-2",children:["(",l,")"]})]})}),m&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium mb-1",children:"SignalK Server URL:"}),(0,n.jsx)("input",{type:"text",className:"border p-2 w-full text-black rounded",value:s.signalkUrl||"",onChange:e=>j({signalkUrl:e.target.value})})]}),(0,n.jsx)("div",{children:(0,n.jsxs)("label",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",className:"mr-2",checked:u,onChange:e=>{h(e.target.checked),b(s)}}),"Use Authentication"]})}),u&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium mb-1",children:"Username:"}),(0,n.jsx)("input",{type:"text",className:"border p-2 w-full text-black rounded",value:s.username||"",onChange:e=>j({username:e.target.value})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium mb-1",children:"Password:"}),(0,n.jsx)("input",{type:"password",className:"border p-2 w-full text-black rounded",value:s.password||"",onChange:e=>j({password:e.target.value})})]})]})]})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Vessel Settings"}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium mb-1",children:"Select Vessel:"}),(0,n.jsxs)("select",{className:"border p-2 w-full text-black rounded",value:s.selectedBoat||"",onChange:e=>{let t=e.target.value;f(o.find(e=>e.name===t)||null),j({selectedBoat:t})},children:[(0,n.jsx)("option",{value:"",children:"-- Select a Vessel --"}),o.map(e=>(0,n.jsx)("option",{value:e.name,children:e.name},e.name))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium mb-1",children:"Vessel Color:"}),(0,n.jsx)("input",{type:"color",className:"w-full h-10 rounded",value:s.primaryColor||"#000000",onChange:e=>j({primaryColor:e.target.value})})]}),(0,n.jsx)("div",{children:(0,n.jsxs)("label",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",className:"mr-2",checked:s.metallicEffect||!1,onChange:e=>j({metallicEffect:e.target.checked})}),"Enable Metallic Effect"]})})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h2",{className:"text-xl font-semibold",children:"Advanced Settings"}),(0,n.jsx)("div",{children:(0,n.jsxs)("label",{className:"flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",className:"mr-2",checked:s.debugMode||!1,onChange:e=>j({debugMode:e.target.checked,signalkUrl:l})}),"Debug Mode"]})}),x&&s.debugMode&&(0,n.jsxs)("div",{className:"space-y-2 text-sm text-gray-400",children:[(0,n.jsxs)("div",{children:["3D Model: ",x.modelPath]}),(0,n.jsxs)("div",{children:["Features: ",null===(t=x.capabilities)||void 0===t?void 0:t.join(", ")]})]})]}),(0,n.jsxs)("div",{className:"flex space-x-4 pt-4",children:[(0,n.jsx)("button",{onClick:w,className:"bg-oBlue text-white px-4 py-2 rounded hover:bg-blue-600",children:"Save Configuration"}),(0,n.jsx)("button",{onClick:()=>{let e=d.getDefaultConfig();c(e),h(!1),g(!1),d.saveConfig(e),v(!1)},className:"bg-oRed text-white px-4 py-2 rounded hover:bg-red-600",children:"Reset Configuration"})]})]})]})},h=a(4578),m=a(2079);let g=(0,i.createContext)(),x="#09bfff",f="#cc000c",p="#0fcd4f",v=e=>null!=e?Math.round((e-273.15)*10)/10:null,b=e=>null!=e?Math.round(19.4384*e)/10:null,j={WARNING_THRESHOLD:50,DANGER_THRESHOLD:20,CHARGING_THRESHOLD:13},w=e=>e>=12.7?100:e>=12.5?75:e>=12.3?50:e>=12.1?25:0,y={wind:{"environment.wind.angleTrueWater":m.M8C.degToRad(25),"environment.wind.speedTrue":20,"environment.wind.angleApparent":m.M8C.degToRad(23),"environment.wind.speedApparent":25},temperature:{"environment.water.temperature":290.15,"environment.outside.temperature":294.15,"propulsion.main.exhaustTemperature":368.15,"environment.inside.fridge.temperature":277.15},environment:{"environment.outside.pressure":102300,"environment.inside.relativeHumidity":.74,"environment.inside.voc":.03},performance:{"performance.beatAngle":m.M8C.degToRad(45),"performance.gybeAngle":m.M8C.degToRad(135),"performance.beatAngleVelocityMadeGood":6,"performance.gybeAngleVelocityMadeGood":5,"performance.targetAngle":m.M8C.degToRad(45),"performance.polarSpeed":8,"performance.polarSpeedRatio":.95,"performance.velocityMadeGood":5,"performance.polarVelocityMadeGood":6,"performance.polarVelocityMadeGoodRatio":.9},navigation:{"navigation.speedThroughWater":7,"navigation.headingTrue":m.M8C.degToRad(0),"navigation.courseOverGround":m.M8C.degToRad(20),"navigation.courseGreatCircle.nextPoint.bearingTrue":m.M8C.degToRad(30),"navigation.attitude.roll":m.M8C.degToRad(5)},racing:{"navigation.racing.layline":m.M8C.degToRad(10),"navigation.racing.layline.distance":100,"navigation.racing.layline.time":180,"navigation.racing.oppositeLayline":m.M8C.degToRad(45),"navigation.racing.oppositeLayline.distance":80,"navigation.racing.oppositeLayline.time":180,"navigation.racing.startLineStb":{latitude:0,longitude:0,altitude:0},"navigation.racing.startLinePort":{latitude:0,longitude:0,altitude:0},"navigation.racing.distanceStartline":50,"navigation.racing.timeToStart":120,"navigation.racing.timePortDown":60,"navigation.racing.timePortUp":70,"navigation.racing.timeStbdDown":65,"navigation.racing.timeStbdUp":75}},M=e=>{let{children:t}=e,[a,r]=(0,i.useState)({}),[l,o]=(0,i.useState)(!1),[s,c]=(0,i.useState)({autopilot:!0,anchorWatch:!1,parkingMode:!1,mob:!1,showOcean:!1,ais:!1}),u=(0,i.useRef)(null),x=(0,i.useRef)(null);return(0,i.useEffect)(()=>{let e=async()=>{let e=new Date,t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0"),n="tides/larochelle/".concat(a,"_").concat(t,".json"),i=await fetch(n);if(i.ok){let t=await i.json(),a=e.toISOString().split("T")[0];if(t[a]){let e=null,n=null,i=new Date,l=60*i.getHours()+i.getMinutes();if(t[a].forEach(t=>{let[a,i,r,o]=t,[s,c]=i.split(":").map(Number),d=60*s+c;"tide.high"===a&&(!e||Math.abs(l-d)<Math.abs(l-e.timeInMinutes))?e={height:parseFloat(r),time:i,timeInMinutes:d,coef:o}:"tide.low"===a&&(!n||Math.abs(l-d)<Math.abs(l-n.timeInMinutes))&&(n={height:parseFloat(r),time:i,timeInMinutes:d})}),e&&n){let t="".concat(i.getHours().toString().padStart(2,"0"),":").concat(i.getMinutes().toString().padStart(2,"0")),a=T(e.height,n.height,t,e.time,n.time);r(t=>({...t,"environment.tide.heightNow":a,"environment.tide.heightHigh":e.height,"environment.tide.heightLow":n.height,"environment.tide.timeLow":n.time,"environment.tide.timeHigh":e.time,"environment.tide.coeffNow":e.coef}))}else throw Error("Tide data for today is incomplete.")}}else console.warn("No tide data found")};return(async()=>{let e=d.getAll(),{signalkUrl:t,debugMode:a}=e;try{let[a,n]=t.replace(/https?:\/\//,"").split(":"),i=new h.default({hostname:a||"localhost",port:parseInt(n)||3e3,useTLS:t.startsWith("https"),reconnect:!0,autoConnect:!1,notifications:!1,deltaStreamBehaviour:"self",sendMeta:"all",wsKeepaliveInterval:10});u.current=i,await i.connect(),i.on("delta",e=>{e.updates.forEach(e=>{e.values&&e.values.forEach(e=>{r(t=>({...t,[e.path]:e.value}))})})}),e.debugMode&&(x.current=setInterval(()=>{let e=Math.floor(91*Math.random())-45;r(t=>({...t,"steering.rudderAngle":m.M8C.degToRad(e),...y.wind,...y.temperature,...y.environment,...y.performance,...y.navigation,...y.racing}))},5e3))}catch(e){console.error("Failed to connect to SignalK:",e)}})(),e(),()=>{u.current&&u.current.disconnect(),x.current&&clearInterval(x.current)}},[]),(0,n.jsx)(g.Provider,{value:{getSignalKValue:e=>a[e]||null,nightMode:l,setNightMode:o,states:s,toggleState:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;c(a=>({...a,[e]:void 0!==t?t:!a[e]}))}},children:t})},N=()=>(0,i.useContext)(g),T=function(e,t,a,n,i){let r,l,o,s;let c=e=>{let[t,a]=e.split(":").map(Number);return 60*t+a},d=c(n),u=c(i),h=c(a),m=!1;u<=h&&h<=d?(m=!0,r=t,l=e,o=u,s=d):(r=e,l=t,o=d,s=u+(u<d?1440:0));let g=Math.abs(s-o),x=Math.abs(l-r),f=h-o;f<0&&(f+=1440);let p=x/12,v=0;return v=f<=g/6?p*Math.ceil(f/(g/12)):f<=2*g/6?2*p+p*Math.ceil((f-g/6)/(g/12)):f<=3*g/6?5*p:f<=4*g/6?8*p:f<=5*g/6?10*p:x,m?r+v:r-v};var S=()=>{let{nightMode:e}=N(),[t,a]=(0,i.useState)(null),[r,l]=(0,i.useState)(!1),o=e=>{e.external,a(e),l(!1)},s=e=>{window.open(e,"_blank","noopener,noreferrer")};return(0,n.jsxs)("div",{className:"rightPaneBg ".concat(e?"text-oNight bg-oGray2":"text-gray-900 bg-oGray"," flex flex-col h-full p-4"),children:[(0,n.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-6",children:[{name:"Netflix",url:"https://www.netflix.com",icon:"/icons/mediaplayer/netflix.png",external:!0},{name:"YouTube",url:"https://www.youtube.com",icon:"/icons/mediaplayer/youtube.png",external:!0},{name:"Disney+",url:"https://www.disneyplus.com",icon:"/icons/mediaplayer/disneyplus.png",external:!0},{name:"Prime Video",url:"https://www.primevideo.com",icon:"/icons/mediaplayer/amazon.png",external:!0},{name:"Deezer",url:"https://widget.deezer.com/widget/dark/playlist/1479458365",icon:"/icons/mediaplayer/deezer.png"}].map(e=>(0,n.jsx)("button",{onClick:()=>o(e),className:"rounded-lg flex items-center justify-center transition-colors hover:bg-oGray3 relative w-64 h-64",children:(0,n.jsx)("img",{src:e.icon,alt:e.name,className:"w-full h-full object-contain",loading:"lazy"})},e.name))}),t&&(0,n.jsxs)("div",{className:"mt-6 flex-1 flex flex-col relative",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold ".concat(e?"text-oNight":"text-gray-900"),children:t.name}),(0,n.jsx)("button",{onClick:()=>{a(null),l(!1)},className:"text-sm ".concat(e?"text-oNight hover:text-oRed":"text-gray-900 hover:text-red-500"),children:"Close"})]}),t.external?(0,n.jsxs)("div",{className:"w-full h-full flex flex-col items-center justify-center bg-oGray3 rounded-lg p-6",children:[(0,n.jsx)("div",{className:"w-32 h-32 mb-4 relative",children:(0,n.jsx)("img",{src:t.icon,alt:t.name,className:"w-full h-full object-contain",loading:"lazy"})}),(0,n.jsxs)("p",{className:"text-lg ".concat(e?"text-oNight":"text-gray-900"),children:[t.name," cannot be embedded directly."]}),(0,n.jsx)("p",{className:"text-sm ".concat(e?"text-oNight":"text-gray-600"," mb-4"),children:"Click below to open in a new tab."}),(0,n.jsxs)("button",{onClick:()=>s(t.url),className:"px-4 py-2 rounded-lg ".concat(e?"bg-oNight text-white hover:bg-oRed":"bg-gray-900 text-white hover:bg-red-500"," transition-colors"),children:["Open ",t.name]})]}):r?(0,n.jsxs)("div",{className:"w-full h-full flex items-center justify-center text-red-500",children:["Unable to embed ",t.name,"."," ",(0,n.jsx)("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"underline ml-2 hover:text-red-700",children:"Open in new tab"})]}):(0,n.jsx)("iframe",{src:t.url,title:t.name,className:"w-full h-full rounded-lg border-0",allow:"autoplay; encrypted-media",allowFullScreen:!0,loading:"lazy",onError:()=>{l(!0)}})]})]})},C=()=>{let{nightMode:e,getSignalKValue:t}=N(),a=(0,i.useRef)(performance.now()),r=(0,i.useRef)(performance.now()),l=(0,i.useRef)(0),o=(0,i.useCallback)(()=>{let e=new Date().toLocaleTimeString(),a=t("electrical.batteries.1.voltage")||12,n=t("electrical.batteries.1.capacity.stateOfCharge");return{time:e,voltage:a,current:t("electrical.batteries.1.current")||5,stateOfCharge:null!==n?n:w(a)}},[t]),[s,c]=(0,i.useState)(()=>Array(30).fill(null).map(o)),[d,u]=(0,i.useState)(()=>{let e=new Date().toLocaleTimeString();return Array(30).fill({time:e,fps:60,ms:16.67})}),h=(0,i.useCallback)(e=>{let a=s[s.length-1],n=t("electrical.batteries.1.voltage")||a.voltage,i=t("electrical.batteries.1.current")||a.current,r=t("electrical.batteries.1.capacity.stateOfCharge"),l=null!==r?r:w(n);return{time:e,voltage:n,current:i,stateOfCharge:l}},[t,s]);(0,i.useEffect)(()=>{let e;let t=()=>{let n=new Date().toLocaleTimeString();l.current++;let i=performance.now();if(a.current,i>=r.current+1e3){let e=1e3*l.current/(i-r.current),t=e>0?1e3/e:0;u(a=>[...a.slice(1),{time:n,fps:e,ms:t}]),c(e=>[...e.slice(1),h(n)]),r.current=i,l.current=0}a.current=i,e=requestAnimationFrame(t)};return e=requestAnimationFrame(t),()=>cancelAnimationFrame(e)},[h]);let m=e=>e>j.WARNING_THRESHOLD?"bg-oGreen":e>j.DANGER_THRESHOLD?"bg-oYellow":"bg-oRed";return(0,n.jsx)("div",{className:"p-6 flex flex-col h-full bg-rightPaneBg",children:(0,n.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,n.jsxs)("div",{className:"bg-oGray2 rounded-lg shadow-lg p-4",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold ".concat(e?"text-oNight":"text-white"," mb-4"),children:"Battery Status"}),(0,n.jsxs)("div",{className:"h-64 relative",children:[(0,n.jsx)("div",{className:"absolute inset-0",children:Array.from({length:5},(t,a)=>(0,n.jsx)("div",{className:"absolute w-full border-t border-gray-300 opacity-20",style:{bottom:"".concat(a/4*100,"%")},children:(0,n.jsxs)("span",{className:"absolute -left-10 text-xs ".concat(e?"text-oNight":"text-white"),children:[0+25*a,"%"]})},a))}),(0,n.jsx)("div",{className:"h-full flex items-end space-x-1",children:s.map((t,a)=>(0,n.jsxs)("div",{className:"flex-1 flex flex-col justify-end h-full space-y-1 relative",children:[(0,n.jsx)("div",{className:"w-full bg-blue-500 transition-all duration-300",style:{height:"".concat((t.voltage-11)/4*100,"%")},title:"Voltage: ".concat(t.voltage.toFixed(1),"V")}),(0,n.jsx)("div",{className:"w-full bg-red-500 transition-all duration-300",style:{height:"".concat(t.current/15*100,"%")},title:"Current: ".concat(t.current.toFixed(1),"A")}),(0,n.jsx)("div",{className:"w-full ".concat(m(t.stateOfCharge)," transition-all duration-300"),style:{height:"".concat(t.stateOfCharge,"%")},title:"SoC: ".concat(t.stateOfCharge.toFixed(1),"%")}),a%5==0&&(0,n.jsx)("span",{className:"text-xs ".concat(e?"text-oNight":"text-white"," transform -rotate-45 origin-top-left absolute bottom-0 -mb-6"),children:t.time.split(":")[1]})]},"".concat(t.time,"-").concat(a)))})]}),(0,n.jsxs)("div",{className:"mt-4 flex justify-between text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-blue-500 rounded mr-2"}),(0,n.jsx)("span",{className:e?"text-oNight":"text-white",children:"Voltage (11-15V)"})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded mr-2"}),(0,n.jsx)("span",{className:e?"text-oNight":"text-white",children:"Current (0-15A)"})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-oGreen rounded mr-2"}),(0,n.jsx)("span",{className:e?"text-oNight":"text-white",children:"SoC (0-100%)"})]})]})]}),(0,n.jsxs)("div",{className:"bg-oGray2 rounded-lg shadow-lg p-4",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold ".concat(e?"text-oNight":"text-white"," mb-4"),children:"Performance Metrics"}),(0,n.jsxs)("div",{className:"h-64 relative",children:[(0,n.jsx)("div",{className:"absolute inset-0",children:Array.from({length:5},(t,a)=>(0,n.jsx)("div",{className:"absolute w-full border-t border-gray-300 opacity-20",style:{bottom:"".concat(a/4*100,"%")},children:(0,n.jsx)("span",{className:"absolute -left-10 text-xs ".concat(e?"text-oNight":"text-white"),children:0+15*a})},a))}),(0,n.jsx)("div",{className:"h-full flex items-end space-x-1",children:d.map((t,a)=>(0,n.jsxs)("div",{className:"flex-1 flex flex-col justify-end h-full space-y-1 relative",children:[(0,n.jsx)("div",{className:"w-full bg-cyan-500 transition-all duration-300",style:{height:"".concat(t.fps/60*100,"%")},title:"FPS: ".concat(t.fps.toFixed(1))}),(0,n.jsx)("div",{className:"w-full bg-green-500 transition-all duration-300",style:{height:"".concat(t.ms/33.33*100,"%")},title:"MS: ".concat(t.ms.toFixed(1))}),a%5==0&&(0,n.jsx)("span",{className:"text-xs ".concat(e?"text-oNight":"text-white"," transform -rotate-45 origin-top-left absolute bottom-0 -mb-6"),children:t.time.split(":")[1]})]},"".concat(t.time,"-").concat(a)))})]}),(0,n.jsxs)("div",{className:"mt-4 flex justify-between text-sm",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-cyan-500 rounded mr-2"}),(0,n.jsx)("span",{className:e?"text-oNight":"text-white",children:"FPS (0-60)"})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded mr-2"}),(0,n.jsx)("span",{className:e?"text-oNight":"text-white",children:"Frame Time (0-33ms)"})]})]})]}),(0,n.jsxs)("div",{className:"bg-oGray2 rounded-lg shadow-lg p-4 md:col-span-2",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold ".concat(e?"text-oNight":"text-white"," mb-4"),children:"Current Readings"}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("p",{className:"text-sm font-medium ".concat(e?"text-oNight":"text-white"),children:"Voltage"}),(0,n.jsxs)("p",{className:"text-2xl font-bold ".concat(e?"text-oNight":"text-white"),children:[s[s.length-1].voltage.toFixed(1)," V"]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("p",{className:"text-sm font-medium ".concat(e?"text-oNight":"text-white"),children:"Current"}),(0,n.jsxs)("p",{className:"text-2xl font-bold ".concat(e?"text-oNight":"text-white"),children:[s[s.length-1].current.toFixed(1)," A"]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("p",{className:"text-sm font-medium ".concat(e?"text-oNight":"text-white"),children:"State of Charge"}),(0,n.jsxs)("p",{className:"text-2xl font-bold ".concat(e?"text-oNight":"text-white"),children:[s[s.length-1].stateOfCharge.toFixed(1),"%"]})]}),(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)("p",{className:"text-sm font-medium ".concat(e?"text-oNight":"text-white"),children:"Performance"}),(0,n.jsxs)("p",{className:"text-2xl font-bold ".concat(e?"text-oNight":"text-white"),children:[d[d.length-1].fps.toFixed(1)," FPS",(0,n.jsxs)("span",{className:"text-sm ml-2",children:["(",d[d.length-1].ms.toFixed(1)," ms)"]})]})]})]})]})]})})};let E={latitude:46.1591,longitude:-1.1522},R={navigation:e=>"".concat(e,"/@signalk/freeboard-sk/"),instrument:e=>"".concat(e,"/@mxtommy/kip/"),netflix:()=>"https://www.netflix.com",battery:e=>e.replace(":3000",":3001")+"/grafana",webcam1:()=>"https://pv.viewsurf.com/2080/Chatelaillon-Port?i=NzU4Mjp1bmRlZmluZWQ",webcam2:()=>"https://pv.viewsurf.com/1478/Chatelaillon-Plage&lt?i=NTkyMDp1bmRlZmluZWQ",weather:(e,t)=>t&&"https://embed.windy.com/embed.html?type=map&location=coordinates&metricRain=mm&metricTemp=\xb0C&metricWind=kt&zoom=10&overlay=wind&product=ecmwf&level=surface&lat=".concat(t.latitude,"&lon=").concat(t.longitude,"&message=true")};var P=e=>{let{view:t}=e,{getSignalKValue:a}=N(),[r,l]=(0,i.useState)(null),[s,c]=(0,i.useState)(null),{signalkUrl:h}=d.getAll();(0,i.useEffect)(()=>{let e=()=>{try{let e=a("navigation.position")||E;l(t=>t?Math.abs(t.latitude-e.latitude)>.01||Math.abs(t.longitude-e.longitude)>.01?e:t:e),c(null)}catch(e){c("Error fetching position data"),console.error("Position fetch error:",e)}};e();let t=setInterval(e,1e4);return()=>clearInterval(t)},[a]);let m=(0,i.useMemo)(()=>{let e=R[t];if(!e)return null;try{return e(h,r)}catch(e){return console.error("Error generating URL:",e),c("Error generating application URL"),null}},[t,r,h]);return(0,n.jsx)("div",{className:"flex flex-col w-full h-full",children:(()=>{if(s)return(0,n.jsx)("div",{className:"text-red-500 p-4",children:s});switch(t){case"manual":return(0,n.jsx)(o,{path:"boats/default/docs"});case"settings":return(0,n.jsx)(u,{});case"mediaplayer":return(0,n.jsx)(S,{});case"battery":return(0,n.jsx)(C,{});default:return m&&(0,n.jsx)("iframe",{className:"flex-grow border-none",src:m,title:"External Application",onError:()=>c("Failed to load external content")})}})()})},I=a(1268),A=a(5217);let _={waterTemp:{key:"waterTemp",path:"environment.water.temperature",icon:A.L02,label:"Water Temperature",format:e=>"".concat(e,"\xb0C"),transform:v},airTemp:{key:"airTemp",path:"environment.outside.temperature",icon:A.whq,label:"Air Temperature",format:e=>"".concat(e,"\xb0C"),transform:v},exhaustTemp:{key:"exhaustTemp",path:"propulsion.main.exhaustTemperature",icon:A.Rpv,label:"Exhaust Temperature",format:e=>"".concat(e,"\xb0C"),transform:v},fridgeTemp:{key:"fridgeTemp",path:"environment.inside.fridge.temperature",icon:A.jOV,label:"Fridge Temperature",format:e=>"".concat(e,"\xb0C"),transform:v}},k=e=>{let{mode:t,value:a,icon:i,nightMode:r}=e;return a||0===a?(0,n.jsxs)("div",{className:"flex items-center text-2xl ".concat(r?"text-red-500":"text-white"),children:[(0,n.jsx)(I.G,{icon:i,className:"mr-2"}),(0,n.jsx)("span",{children:_[t].format(a)})]}):null};var L=()=>{let{nightMode:e,getSignalKValue:t}=N(),[a,r]=(0,i.useState)([]),[l,o]=(0,i.useState)(null),s=(0,i.useMemo)(()=>Object.entries(_).reduce((e,a)=>{let[n,i]=a,r=t(i.path);return e[n]=null!==r?i.transform(r):null,e},{}),[t]);(0,i.useEffect)(()=>{let e=Object.entries(s).filter(e=>{let[t,a]=e;return null!==a}).map(e=>{let[t]=e;return t});r(e),e.length>0&&!e.includes(l)&&o(e[0])},[s,l]);let c=()=>{if(a.length<=1)return;let e=(a.indexOf(l)+1)%a.length;o(a[e])};return 0===a.length?(0,n.jsx)("div",{className:"text-2xl ".concat(e?"text-red-500":"text-white"),children:(0,n.jsx)("span",{children:"NA"})}):(0,n.jsx)("div",{className:"cursor-pointer flex items-center space-x-2",onClick:c,title:"Toggle Temperature Display (".concat(a.length," sensors available)"),role:"button",tabIndex:0,onKeyPress:e=>"Enter"===e.key&&c(),"aria-label":l?_[l].label:"No temperature data available",children:l&&(0,n.jsx)(k,{mode:l,value:s[l],icon:_[l].icon,nightMode:e})})};let O={pressure:{key:"pressure",path:"environment.outside.pressure",icon:A.uM9,format:e=>"".concat(e," hPa"),transform:e=>null!=e?Math.round(e/100*10)/10:null},humidity:{key:"humidity",path:"environment.inside.relativeHumidity",icon:A.Zkk,format:e=>"".concat(e.toFixed(1),"%"),transform:e=>100*e},voc:{key:"voc",path:"environment.inside.voc",icon:A.DSs,format:e=>"".concat(e," ppm"),transform:e=>e}},F=e=>{let{mode:t,value:a,icon:i,nightMode:r}=e;return a||0===a?(0,n.jsxs)("div",{className:"flex items-center text-2xl ".concat(r?"text-red-500":"text-white"),children:[(0,n.jsx)(I.G,{icon:i,className:"mr-2"}),(0,n.jsx)("span",{children:O[t].format(a)})]}):null};var G=()=>{let{nightMode:e,getSignalKValue:t}=N(),[a,r]=(0,i.useState)([]),[l,o]=(0,i.useState)(null),s=(0,i.useMemo)(()=>Object.entries(O).reduce((e,a)=>{let[n,i]=a,r=t(i.path);return e[n]=null!==r?i.transform(r):null,e},{}),[t]);(0,i.useEffect)(()=>{let e=Object.entries(s).filter(e=>{let[t,a]=e;return null!==a}).map(e=>{let[t]=e;return t});r(e),e.length>0&&!e.includes(l)&&o(e[0])},[s,l]);let c=()=>{if(a.length<=1)return;let e=(a.indexOf(l)+1)%a.length;o(a[e])};return 0===a.length?(0,n.jsx)("div",{className:"text-2xl ".concat(e?"text-red-500":"text-white"),children:(0,n.jsx)("span",{children:"NA"})}):(0,n.jsx)("div",{className:"cursor-pointer flex items-center space-x-2",onClick:c,title:"Toggle Environmental Display (".concat(a.length," modes available)"),role:"button",tabIndex:0,onKeyPress:e=>"Enter"===e.key&&c(),children:l&&(0,n.jsx)(F,{mode:l,value:s[l],icon:O[l].icon,nightMode:e})})};let D=e=>{let{icon:t,onClick:a,label:i,textColor:r}=e;return(0,n.jsx)("button",{onClick:a,className:"".concat(r," text-2xl flex items-center justify-center hover:text-gray-300 transition-colors duration-200"),"aria-label":i,children:(0,n.jsx)(I.G,{icon:t})})};var B=e=>{let{setRightView:t,toggleSettings:a,toggleAppMenu:i}=e,{nightMode:r}=N(),l=r?"text-oNight":"text-white",o=[{section:"left",items:[{icon:A.lnS,onClick:()=>a(),label:"Settings"}]},{section:"center",items:[{icon:A.tLL,onClick:()=>t("navigation"),label:"Navigation"},{icon:A.S9Y,onClick:()=>t("weather"),label:"Weather"},{icon:A.szN,onClick:i,label:"App Menu"},{icon:A.iGi,onClick:()=>t("manual"),label:"Manual"},{icon:A.HLz,onClick:()=>t("instrument"),label:"Instrument"}]}],s=e=>{let t=o.find(t=>t.section===e);return t?t.items.map((t,a)=>(0,n.jsx)(D,{icon:t.icon,onClick:t.onClick,label:t.label,textColor:l},"".concat(e,"-").concat(a))):null};return(0,n.jsxs)("div",{className:"flex items-center justify-between w-full h-full bg-black px-4",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-10",children:[s("left"),(0,n.jsx)(L,{})]}),(0,n.jsx)("div",{className:"flex items-center justify-center space-x-10",children:s("center")}),(0,n.jsx)("div",{className:"flex items-center space-x-10",children:(0,n.jsx)(G,{})})]})},U=e=>{let{currentViewMode:t,toggleViewMode:a,handleSetRightView:i,toggleFullscreen:r,setShowAppMenu:l}=e,o=e=>{let{icon:t,label:a,onClick:i}=e;return(0,n.jsxs)("button",{onClick:()=>{i(),l(!1)},className:"flex items-center text-white p-2 rounded-md hover:bg-gray-700 transition",children:[(0,n.jsx)(I.G,{icon:t,className:"mr-2"})," ",a]})};return(0,n.jsx)("div",{className:"fixed bottom-20 left-1/2 transform -translate-x-1/2 bg-black p-6 rounded-lg shadow-lg z-50 w-200",children:(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[t!==tm.SPLIT&&(0,n.jsx)(o,{icon:A.TL5,label:"Split View",onClick:()=>a(tm.SPLIT)}),t!==tm.APP&&(0,n.jsx)(o,{icon:A.TL5,label:"Full View",onClick:()=>a(tm.APP)}),t!==tm.BOAT&&(0,n.jsx)(o,{icon:A.lnS,label:"Boat View",onClick:()=>a(tm.BOAT)}),(0,n.jsx)(o,{icon:A.iGi,label:"Manual",onClick:()=>i("manual")}),(0,n.jsx)(o,{icon:A.HLz,label:"Instruments",onClick:()=>i("instrument")}),(0,n.jsx)(o,{icon:A.IyC,label:"Webcam",onClick:()=>i("webcam1")}),(0,n.jsx)(o,{icon:A.tLL,label:"Navigation",onClick:()=>i("navigation")}),(0,n.jsx)(o,{icon:A.Kb6,label:"Settings",onClick:()=>i("settings")}),(0,n.jsx)(o,{icon:A.S9Y,label:"Weather",onClick:()=>i("weather")}),(0,n.jsx)(o,{icon:A.RoX,label:"Battery",onClick:()=>i("battery")}),(0,n.jsx)(o,{icon:A.ItS,label:"Media player",onClick:()=>i("mediaplayer")}),(0,n.jsx)(o,{icon:A.TL5,label:"Toggle Fullscreen",onClick:r}),(0,n.jsx)(o,{icon:A.d8e,label:"Refresh Page",onClick:()=>{window.location.reload()}})]})})},z=a(6496),W=a(8328),H=a(4725),V=a(5903),Y=a(5550),K=a(8124),X=a(1106);function q(e,t,a){return e/1.9438444924574*Math.pow(t/10,a)*1.9438444924574}var Z=a(3359),J=a(1378),Q=a(262),$=new WeakMap,ee=new WeakMap;class et{calcShape(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;(0,Q._)(this,ee,[]);let t=this.chordTackLevel/((0,Z._)(this,$)[(0,Z._)(this,$).length-1].x-(0,Z._)(this,$)[0].x);for(let a of(0,Z._)(this,$)){let n=a.clone().multiplyScalar(t);1!==e&&(n.y*=e),(0,Z._)(this,ee).push(n)}let a=new m.FM8(0,0);for(let e of(0,Z._)(this,ee))e.y>a.y&&(a=e);this.draftDepth=a.y,this.draftPosition=a.x,this.girth=0;let n=null;for(let e of(0,Z._)(this,ee))null!==n&&(this.girth+=e.distanceTo(n)),n=e;this.sag=this.chordTackLevel-this.girth,this.entryAngleRad=(0,Z._)(this,ee)[1].clone().sub((0,Z._)(this,ee)[0]).angle(),this.exitAngleRad=(0,Z._)(this,ee)[(0,Z._)(this,ee).length-1].clone().sub((0,Z._)(this,ee)[(0,Z._)(this,ee).length-2]).angle()-2*Math.PI,this.mastAngleRad=this.calcMastAngle(),this.forceAngleRad=(this.entryAngleRad+this.exitAngleRad)/2,this.draftDepthRatio=this.draftDepth/this.chordTackLevel,this.draftPositionRatio=this.draftPosition/this.chordTackLevel}calcMastAngle(){let e=0,t=null,a=this.mastWidth*this.chordTackLevel/this.chordMastTop;for(let n of(0,Z._)(this,ee)){if(null!==t&&(e+=n.distanceTo(t))>=a)return n.angle();t=n}return NaN}getVerticesAngles(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=(this.girth-t)/(e-1),i=0,r=0,l=[],o=null;for(let s of(0,Z._)(this,ee)){if(null!==o&&(((r+=s.distanceTo(o))>=i*n+t||a&&r>a)&&(i++,l.push(s.angle())),i>=e))break;o=s}return l}pointAtGirthDistance(e){let t=0,a=null;for(let n of(0,Z._)(this,ee))if(null!==a&&(t+=n.distanceTo(a)),a=n,t>=e)return a.clone()}constructor(e,t,a,n=1){(0,J._)(this,$,{writable:!0,value:void 0}),(0,J._)(this,ee,{writable:!0,value:void 0}),(0,Q._)(this,$,[]),(0,Q._)(this,ee,[]),this.chordMastTop=t,this.chordTackLevel=e,this.mastWidth=a;let i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return new m.FM8(t*e**2,2*t*e)},r=1.001+.95*(n-1)/10,l=(r-.001)/1e3,o=i(.001),s=i(r).clone().sub(o).angle(),c=new m.FM8(0,0);for(let e=.001;e<=r;e+=l){let t=i(e);t.sub(o),t.rotateAround(c,-s),(0,Z._)(this,$).push(t)}this.calcShape(1-.25*(n-1)/10)}}let ea=Math.floor(20),en=Math.ceil(160),ei={waterlineToMastFootHeight:.45,maxMastRotation:Math.PI/2,maxChordRotationPerSailLevel:Math.PI/3*2};var er=e=>{let{windParams:t={speed:5,hellman:.27},boatParams:a={mastrotation:0,heading:130,speed:5},sailParams:r={mastArea:0,sailArea:0,cunningham:1,angleOfAttack:20}}=e,{getSignalKValue:l}=N(),o=(0,i.useRef)(),s=(0,i.useRef)(null),c=(0,i.useRef)(0),d=(0,i.useRef)(null),u=(0,i.useRef)(null),h=(0,i.useRef)(),g=(0,i.useRef)({}),f=(0,i.useMemo)(()=>{let e=new m.ZAu,t=new m.b_z(.1,.2,12),a=new m.Wid({color:x,opacity:.5,transparent:!0}),n=new m.Kj0(t,a);return n.position.set(0,-.1,0),e.add(n),e},[]);(0,i.useEffect)(()=>{let e=new m.ZAu,t={};for(let a=0;a<8;a+=.5){let n=f.clone();n.position.set(0,a,0),t[2*a]=n,e.add(n)}return e.position.set(0,0,0),h.current&&h.current.add(e),g.current=t,()=>{e.clear()}},[f]);let p=(e,t)=>{let a=g.current;if(!a){console.error("apparentWindField is not initialized.");return}for(let n=0;n<8;n+=.5){let i=q(e,n,t),r=a[2*n];if(!r){console.warn("Apparent wind field cone at height ".concat(n," is not defined."));continue}r.scale.set(.1*i,i,.1*i),r.rotation.set(0,-Math.PI,Math.PI/2)}},{geometry:v,sailClipWidthPerLevel:b}=(0,i.useMemo)(()=>{let e=new m.u9r,t=[],a=[],n=[];for(let e=0;e<=en;e++){let i,r;let l=Math.min(50*e,8e3);l<900?(i=3600,r=3800+-200*l/900):r=i=3600-3210*(l-900)/7100+600*Math.sin((l-900)/7100*Math.PI);let o=0;for(let n=0;n<ea;n++){let s=i/(ea-1),c=s*n-r,d=s;c>.1&&(d=c>s?0:s-c),t.push(0===n?0:(o+d)/1e3,l/1e3,0),o=0===n?0:o+d;let u=Math.floor(en/10);a.push(...e%u==0?[.8,0,.047]:[.596,.596,.596])}n.push(r===i?null:r)}let i=[];for(let e=0;e<en;e++)for(let t=1;t<ea;t++){let a=e*ea+t;i.push(a-1,a,a+ea-1,a,a+ea,a+ea-1)}return e.setAttribute("position",new m.a$l(t,3)),e.setAttribute("color",new m.a$l(a,3)),e.setIndex(i),e.computeVertexNormals(),{geometry:e,sailClipWidthPerLevel:n}},[]),j=(0,i.useMemo)(()=>l("environment.wind.angleApparent")||0,[l]),w=(0,i.useMemo)(()=>l("environment.wind.speedApparent")||0,[l]);return(0,i.useEffect)(()=>{if(!o.current)return;p(w,t.hellman);let e=j>Math.PI&&j<=2*Math.PI,n=o.current.geometry,i=n.attributes.position.array;r.cunningham!==d.current&&(u.current=new et(3600,390,200,r.cunningham),d.current=r.cunningham),s.current||(s.current=n.clone());let l=1e3*ei.waterlineToMastFootHeight,h=e?-1:1,g=m.M8C.degToRad(r.angleOfAttack),x=Math.abs(j),f=u.current.mastAngleRad;x<.01&&(g=0);let v=Math.min(x-g+f,ei.maxMastRotation),y=new m.Pa4(0,1,0),M=null;for(let e=0;e<=en;e++){let a=Math.abs({awa:j,aws:q(w,(50*e+l)/1e3,t.hellman)}.awa)-g;a<0?a=0:a>Math.PI/2&&(a=Math.PI/2);let n=a-v;M&&n-M>ei.maxChordRotationPerSailLevel&&(n=M+ei.maxChordRotationPerSailLevel),M=n;let r=b[e],o=u.current.getVerticesAngles(ea,200,r);for(let t=1;t<ea;t++){let a=(e*ea+t)*3,r=new m.Pa4(s.current.attributes.position.array[a],s.current.attributes.position.array[a+1],s.current.attributes.position.array[a+2]);r.applyAxisAngle(y,-(n+o[t])*h),i[a]=r.x,i[a+1]=r.y,i[a+2]=r.z}}n.attributes.position.needsUpdate=!0;let N={...a,mastrotation:v*h};o.current&&o.current.rotateY(c.current-N.mastrotation),c.current=N.mastrotation},[w,j,t.hellman,r.cunningham,r.angleOfAttack,a,b]),(0,n.jsxs)("mesh",{ref:o,position:[0,2,-1],rotation:[0,-Math.PI/2,0],children:[(0,n.jsx)("bufferGeometry",{...v}),(0,n.jsx)("group",{ref:h}),(0,n.jsx)("meshBasicMaterial",{vertexColors:!0,transparent:!0,opacity:.7,side:m.ehD})]})};let el=a(257).env.ASSET_PREFIX||"./",eo=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return"".concat(el,"/boats/").concat(e,"/assets/scene-transformed.glb")},es={name:"Default",modelPath:"default",capabilities:["navigation","rudder","sail","color"]},ec=(0,i.forwardRef)((e,t)=>{let{showSail:a=!1,...r}=e,l=(0,i.useRef)(),o=(0,i.useRef)(),{getSignalKValue:s}=N(),c=d.getAll(),[u,h]=(0,i.useState)(()=>d.getSelectedBoat()||es);(0,i.useEffect)(()=>{h(d.getSelectedBoat()||es)},[c]);let g=(0,i.useMemo)(()=>eo(u.modelPath),[u]),x=(null==u?void 0:u.capabilities)||[],{nodes:f,materials:p}=(0,X.L)(g,"".concat(el,"/draco/")),v=(0,i.useMemo)(()=>({primaryColor:c.primaryColor,metallicEffect:c.metallicEffect||!1}),[c.primaryColor,c.metallicEffect]);(0,i.useEffect)(()=>{(null==p?void 0:p.fiberglass)&&(p.fiberglass.color.set(v.primaryColor),p.fiberglass.metalness=v.metallicEffect?1:0,p.fiberglass.roughness=v.metallicEffect?.2:1,Object.values(p).forEach(e=>{e.map&&(e.map.minFilter=m.wem,e.map.magFilter=m.wem,e.map.anisotropy=1)}))},[p,v]);let b=(0,i.useMemo)(()=>new m.yGw,[]),j=(0,i.useMemo)(()=>new m.Pa4(1,0,0),[]);(0,K.F)(()=>{if(!l.current)return;let e=s("navigation.attitude.roll")||0,t=s("steering.rudderAngle")||0;l.current.rotation.z!==e&&(l.current.rotation.z=e),o.current&&(b.makeRotationFromEuler(new m.USm(-Math.PI/2,Math.PI/2,0)),o.current.setRotationFromMatrix(b),o.current.rotateOnAxis(j,-m.M8C.degToRad(180*t/Math.PI)))});let w=(0,i.useMemo)(()=>{let e={Default:()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("mesh",{geometry:f.baba_metal_0.geometry,material:p.metal,position:[.24,.895,-5.546],rotation:[-Math.PI/2,0,1.968],scale:.027}),(0,n.jsx)("mesh",{geometry:f.camadadirek_fiberglass_0.geometry,material:p.fiberglass,position:[0,5.267,-3.711],rotation:[2.054,0,Math.PI],scale:[-.042,.042,4.707]}),(0,n.jsx)("mesh",{geometry:f.camadanyelkeni_bez_0.geometry,material:p.mcaterial,position:[0,5.267,-3.711],rotation:[2.054,0,Math.PI],scale:[-.042,.042,4.707]}),(0,n.jsx)("mesh",{geometry:f.camadaonbaglay_metal_0.geometry,material:p.metal,position:[0,.891,-5.958],rotation:[-Math.PI/2,0,0],scale:.02}),(0,n.jsx)("mesh",{geometry:f.capa_metal_0.geometry,material:p.metal,position:[0,.671,-6.173],rotation:[-Math.PI/2,0,0],scale:.348}),(0,n.jsx)("mesh",{geometry:f.direk_fiberglass_0.geometry,material:p.fiberglass,position:[0,4.315,-1.056],rotation:[Math.PI/2,0,Math.PI],scale:[-.113,.113,5.203]}),(0,n.jsx)("mesh",{geometry:f.duman_ahsap_0.geometry,material:p.ahsap,position:[-.011,.854,3.487],rotation:[Math.PI,0,Math.PI/2],scale:[.045,.045,.011]}),(0,n.jsx)("mesh",{geometry:f.dumenyuvasi_ahsap_0.geometry,material:p.ahsap,position:[-.011,.299,3.441],rotation:[-Math.PI/2,0,1.571],scale:.094}),(0,n.jsx)("mesh",{geometry:f.dumenyuvasi_cam_0.geometry,material:p.material_5,position:[-.011,.299,3.441],rotation:[-Math.PI/2,0,1.571],scale:.094}),(0,n.jsx)("mesh",{geometry:f.dumenyuvasi_fiberglass_0.geometry,material:p.fiberglass,position:[-.011,.299,3.441],rotation:[-Math.PI/2,0,1.571],scale:.094}),(0,n.jsx)("mesh",{geometry:f.govde_fiberglass2_0.geometry,material:p.fiberglass2,position:[0,.32,-.897],rotation:[0,Math.PI/2,0],scale:[5.11,.454,1.212]}),(0,n.jsx)("mesh",{geometry:f.govde_fiberglass_0.geometry,material:p.fiberglass,position:[0,.32,-.897],rotation:[0,Math.PI/2,0],scale:[5.11,.454,1.212]}),(0,n.jsx)("mesh",{geometry:f.govde_metal_0.geometry,material:p.metal,position:[0,.32,-.897],rotation:[0,Math.PI/2,0],scale:[5.11,.454,1.212]}),(0,n.jsx)("mesh",{geometry:f.halattutucu_fiberglass2_0.geometry,material:p.fiberglass2,position:[-1.044,.939,1.809],rotation:[-Math.PI/2,0,0],scale:[.016,.059,.016]}),(0,n.jsx)("mesh",{geometry:f.ip001_metal_0.geometry,material:p.metal,position:[-.231,7.608,-.621],rotation:[-2.322,.222,-1.556],scale:[.007,.007,.011]}),(0,n.jsx)("mesh",{geometry:f.pervan_fiberglass_0.geometry,material:p.fiberglass,position:[0,-1.005,1.561],rotation:[-Math.PI/2,Math.PI/2,0],scale:[.154,.094,.104]}),(0,n.jsx)("mesh",{geometry:f.pervane_metal_0.geometry,material:p.metal,position:[0,-1.122,1.75],scale:.034}),(0,n.jsx)("mesh",{ref:o,geometry:f.rudder_fiberglass_0.geometry,material:p.fiberglass,position:[0,-1.153,3.486],rotation:[-Math.PI/2,Math.PI/2,0],scale:[.573,.262,.262]}),(0,n.jsx)("mesh",{geometry:f.salma_fiberglass_0.geometry,material:p.fiberglass,position:[0,-1.953,-.739],scale:[.149,.108,.756]}),(0,n.jsx)("mesh",{geometry:f.ustcam_cam_0.geometry,material:p.material_5,position:[-.337,.974,-3.127],rotation:[-Math.PI/2,0,0],scale:[-.183,.133,.025]}),(0,n.jsx)("mesh",{geometry:f.ustcam_fiberglass_0.geometry,material:p.fiberglass,position:[-.337,.974,-3.127],rotation:[-Math.PI/2,0,0],scale:[-.183,.133,.025]}),(0,n.jsx)("mesh",{geometry:f.ustgovde_fiberglass_0.geometry,material:p.fiberglass,position:[0,.832,-2.741],rotation:[-Math.PI/2,0,0],scale:[.566,.7,1.212]}),(0,n.jsx)("mesh",{geometry:f.ustgovdekzak_ahsap_0.geometry,material:p.ahsap,position:[0,.862,-2.741],rotation:[-Math.PI/2,0,0],scale:[.566,.7,1.212]}),(0,n.jsx)("mesh",{geometry:f.vinc_metal_0.geometry,material:p.metal,position:[-1.07,.977,2.02],rotation:[-Math.PI/2,0,0],scale:.065}),(0,n.jsx)("mesh",{geometry:f.yancam002_cam_0.geometry,material:p.material_5,position:[-.984,.591,-3.772],rotation:[Math.PI,-1.241,-Math.PI/2],scale:[.095,.28,.014]}),(0,n.jsx)("mesh",{geometry:f.yancam002_fiberglass_0.geometry,material:p.fiberglass,position:[-.984,.591,-3.772],rotation:[Math.PI,-1.241,-Math.PI/2],scale:[.095,.28,.014]}),(0,n.jsx)("mesh",{geometry:f.yankoruma_metal_0.geometry,material:p.metal,position:[-1.641,.946,2.868],rotation:[-Math.PI/2,0,0],scale:[.01,.01,.159]}),(0,n.jsx)("mesh",{geometry:f.yankoruma_metal_0001.geometry,material:p.metal,position:[-1.641,.946,2.868],rotation:[-Math.PI/2,0,0],scale:[.01,.01,.159]}),(0,n.jsx)("mesh",{geometry:f.yankoruma_metal_0002.geometry,material:p.metal,position:[-1.641,.946,2.868],rotation:[-Math.PI/2,0,0],scale:[.01,.01,.159]}),(0,n.jsx)("mesh",{geometry:f.zincir_metal_0.geometry,material:p.metal,position:[-.001,.88,-6.258],rotation:[-1.56,-.031,-.149],scale:.004}),(0,n.jsx)("mesh",{geometry:f.zincir_metal_0001.geometry,material:p.metal,position:[-.001,.88,-6.258],rotation:[-1.56,-.031,-.149],scale:.004}),(0,n.jsx)("mesh",{geometry:f.zincirdeposu_fiberglass2_0.geometry,material:p.fiberglass2,position:[0,.863,-5.779],rotation:[-Math.PI/2,0,0],scale:[.103,.088,.009]}),(0,n.jsx)("mesh",{geometry:f.zincirmakara_metal_0.geometry,material:p.metal,position:[0,.869,-6.305],rotation:[-2.159,1.564,.59],scale:[.01,.01,.016]}),(0,n.jsx)("mesh",{geometry:f.zincirray_ahsap_0.geometry,material:p.ahsap,position:[0,.864,-6.113],rotation:[-Math.PI/2,0,0],scale:[.017,.181,.003]})]}),Optimist:()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("mesh",{geometry:f.body_body_0.geometry,material:p.body,position:[-.054,.272,-.022],rotation:[-1.571,.01,.01],scale:[1,5.242,1]}),(0,n.jsx)("mesh",{geometry:f.boom_aluminium_0.geometry,material:p.aluminium,position:[-.019,2.771,.964],rotation:[0,.01,-.01],scale:[.15,.15,4.609]}),(0,n.jsx)("mesh",{geometry:f.rubber_joint__0.geometry,material:p.rubber_joint__0,position:[-.008,1.407,3.453],rotation:[1.571,-.01,-.01],scale:[-.037,.056,.079]}),(0,n.jsx)("mesh",{geometry:f.sail_sail_0.geometry,material:p.sail,position:[.038,8.739,.698],rotation:[2.356,1.557,2.356],scale:[-5.728,4.361,4.361]})]}),Ship:()=>(0,n.jsx)("mesh",{geometry:f.Object_10.geometry,material:p.material_0,position:[0,-.55,0],rotation:[-1.558,.002,3.139],scale:.004}),Windsurf:()=>(0,n.jsx)("mesh",{geometry:f["body_Material_#30_0"].geometry,material:p.Material_30,position:[-.007,0,-.071],rotation:[-Math.PI/2,0,0],scale:.002}),Sailboat:()=>(0,n.jsx)("mesh",{geometry:f.sailboat.geometry,material:p.texture,position:[0,-1.5,0],rotation:[-Math.PI,.011,-Math.PI],scale:.219})};return e[u.name]||e.Default},[u.name,f,p]);return(0,n.jsxs)("group",{...r,ref:l,dispose:null,children:[x.includes("sail")&&a&&(0,n.jsx)(er,{}),(0,n.jsx)(w,{})]})});X.L.preload(eo(),"".concat(el,"/draco/")),ec.displayName="SailBoat3D";let ed=(0,a(8345).g)({time:0,speed:1,scale:3,opacity:.5,color:new m.Ilk(7895160),foamColor:new m.Ilk(16777215),waterColor:new m.Ilk(26367),rainbowActive:0},"\n    varying vec2 vUv;\n    varying float vElevation;\n    \n    void main() {\n      vUv = uv;\n      \n      // Add subtle vertex displacement for a wavy effect.\n      float elevation = sin(position.x * 0.2 + position.y * 0.3) * 0.1;\n      vElevation = elevation;\n      vec3 newPosition = position + normal * elevation;\n      \n      gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);\n    }\n  ","\n    uniform float time;\n    uniform float speed;\n    uniform float scale;\n    uniform float opacity;\n    uniform vec3 color;\n    uniform vec3 foamColor;\n    uniform vec3 waterColor;\n    uniform float rainbowActive; // Controls whether the rainbow effect is applied.\n\n    varying vec2 vUv;\n    varying float vElevation;\n\n    // Standard noise functions.\n    vec4 permute(vec4 x) {\n      return mod(((x * 34.0) + 1.0) * x, 289.0);\n    }\n\n    vec2 fade(vec2 t) {\n      return t * t * t * (t * (t * 6.0 - 15.0) + 10.0);\n    }\n\n    float cnoise(vec2 P) {\n      vec4 Pi = floor(P.xyxy) + vec4(0.0, 0.0, 1.0, 1.0);\n      vec4 Pf = fract(P.xyxy) - vec4(0.0, 0.0, 1.0, 1.0);\n      Pi = mod(Pi, 289.0);\n      vec4 ix = Pi.xzxz;\n      vec4 iy = Pi.yyww;\n      vec4 fx = Pf.xzxz;\n      vec4 fy = Pf.yyww;\n      vec4 i = permute(permute(ix) + iy);\n      vec4 gx = 2.0 * fract(i * 0.0243902439) - 1.0;\n      vec4 gy = abs(gx) - 0.5;\n      vec4 tx = floor(gx + 0.5);\n      gx = gx - tx;\n      vec2 g00 = vec2(gx.x, gy.x);\n      vec2 g10 = vec2(gx.y, gy.y);\n      vec2 g01 = vec2(gx.z, gy.z);\n      vec2 g11 = vec2(gx.w, gy.w);\n      vec4 norm = 1.79284291400159 - 0.85373472095314 *\n                  vec4(dot(g00, g00), dot(g10, g10), dot(g01, g01), dot(g11, g11));\n      g00 *= norm.x;\n      g10 *= norm.y;\n      g01 *= norm.z;\n      g11 *= norm.w;\n      float n00 = dot(g00, vec2(fx.x, fy.x));\n      float n10 = dot(g10, vec2(fx.y, fy.y));\n      float n01 = dot(g01, vec2(fx.z, fy.z));\n      float n11 = dot(g11, vec2(fx.w, fy.w));\n      vec2 fade_xy = fade(Pf.xy);\n      vec2 n_x = mix(vec2(n00, n01), vec2(n10, n11), fade_xy.x);\n      float n_xy = mix(n_x.x, n_x.y, fade_xy.y);\n      return 2.3 * n_xy;\n    }\n\n    // HSL to RGB conversion function.\n    vec3 hsl2rgb(vec3 hsl) {\n      vec3 rgb = clamp(abs(mod(hsl.x * 6.0 + vec3(0.0, 4.0, 2.0), 6.0) - 3.0) - 1.0,\n                       0.0, 1.0);\n      rgb = rgb * rgb * (3.0 - 2.0 * rgb);\n      return hsl.z + hsl.y * (rgb - 0.5) * (1.0 - abs(2.0 * hsl.z - 1.0));\n    }\n\n    void main() {\n      // Combine multiple layers of noise to build a complex water pattern.\n      float baseNoise = cnoise(vUv * scale + vec2(time * speed, 0.0));\n      float detailNoise = cnoise(vUv * scale * 2.0 + vec2(time * speed * 1.5, 0.0)) * 0.5;\n      float turbulence = cnoise(vUv * scale * 4.0 + vec2(time * speed * 2.0, 0.0)) * 0.25;\n      float noise = baseNoise + detailNoise + turbulence;\n      \n      // Create a wake pattern.\n      float wake = smoothstep(0.3, 0.7, 1.0 - abs(vUv.x - 0.5) * 2.0);\n      \n      // Create a foam effect.\n      float foam = smoothstep(0.4, 0.6, noise + wake);\n      \n      // Mix water and foam colors, then blend in the base color.\n      vec3 finalColor = mix(waterColor, foamColor, foam);\n      finalColor = mix(finalColor, color, wake * 0.5);\n      \n      // Adjust dynamic opacity.\n      float alpha = opacity * (wake + foam * 0.5) * (1.0 - vUv.y);\n      \n      // Add wave highlights.\n      float highlight = smoothstep(0.2, 0.4, noise + wake) *\n                        (1.0 - smoothstep(0.4, 0.6, noise + wake));\n      finalColor += highlight * foamColor * 0.5;\n      \n      // --- Rainbow Effect ---\n      // When rainbowActive is enabled, overlay a dynamic rainbow gradient.\n      if (rainbowActive > 0.5) {\n        // Cycle the hue based on the horizontal UV and time.\n        float rainbowHue = mod(vUv.x + time * 0.5, 1.0);\n        vec3 rainbowColor = hsl2rgb(vec3(rainbowHue, 1.0, 0.5));\n        // Blend the rainbow with the original finalColor.\n        finalColor = mix(finalColor, rainbowColor, 0.7);\n      }\n      \n      gl_FragColor = vec4(finalColor, alpha);\n    }\n  ");(0,K.e)({TrailShaderMaterial:ed});let eu=e=>{let{color:t="#787878",waterColor:a="#0066ff",foamColor:r="#ffffff",speed:l=1,scale:o=3,opacity:s=.5}=e,c=(0,i.useRef)(),{getSignalKValue:d}=N();return(0,K.F)((e,t)=>{if(c.current){c.current.uniforms.time.value+=t;let e=d("steering.autopilot.state")||!1;c.current.uniforms.rainbowActive.value=e?1:0}}),(0,n.jsxs)("mesh",{rotation:[-Math.PI/2,0,Math.PI/2],position:[0,0,22.5],children:[(0,n.jsx)("planeGeometry",{args:[40,2.2,128,32]}),(0,n.jsx)("trailShaderMaterial",{ref:c,color:new m.Ilk(t),waterColor:new m.Ilk(a),foamColor:new m.Ilk(r),speed:l,scale:o,opacity:s,transparent:!0,depthWrite:!1,blending:m.WMw})]})};var eh=a(4752);(0,K.e)({Water:eh.B});var em=function(){let e=(0,i.useRef)(),t=(0,K.D)(e=>e.gl),a=(0,K.D)(e=>e.scene),r=(0,K.H)(m.dpR,"assets/waternormals.jpg");(0,i.useMemo)(()=>{r.wrapS=r.wrapT=m.rpg},[r]);let l=(0,i.useMemo)(()=>new m._12(1e4,1e4),[]),o=(0,i.useMemo)(()=>({textureWidth:600,textureHeight:450,waterNormals:r,sunDirection:new m.Pa4(0,1,0),sunColor:16777215,waterColor:30654,distortionScale:5,format:t.encoding,reflectivity:0}),[r,t.encoding]);(0,i.useMemo)(()=>{a.environment=null,a.background=null},[a]);let s=0;return(0,K.F)((t,a)=>{(s+=a)>.05&&(e.current&&(e.current.material.uniforms.time.value+=s),s=0)}),(0,n.jsx)("water",{ref:e,args:[l,o],"rotation-x":-Math.PI/2,position:[0,-.1,0]})};let eg=(0,i.createContext)(),ex=()=>(0,i.useContext)(eg),ef=(e,t,a,n)=>{let i=a.split(".").reduce((e,t)=>null==e?void 0:e[t],n);void 0!==i&&(e[t]=i)},ep=e=>{let{children:t}=e,[a,r]=(0,i.useState)({}),[l,o]=(0,i.useState)([]),s=(0,i.useRef)(null);return(0,i.useEffect)(()=>{let e=async e=>{console.log("Fetching static vessel information...");try{let t=await e.API().then(e=>e.vessels()),a=Object.entries(t).map(e=>{let[t,a]=e,n={mmsi:t};return ef(n,"name","name",a),ef(n,"latitude","navigation.position.value.latitude",a),ef(n,"longitude","navigation.position.value.longitude",a),ef(n,"cog","navigation.courseOverGroundTrue.value",a),ef(n,"heading","navigation.headingTrue.value",a),ef(n,"length","design.length.value.overall",a),ef(n,"beam","design.beam.value",a),ef(n,"callsign","communication.callsignVhf",a),ef(n,"shipType","design.aisShipType.value.id",a),n});console.log("Fetched ".concat(a.length," vessels.")),o(a)}catch(e){console.error("Error fetching static vessel info:",e)}},t=e=>{if(!(null==e?void 0:e.updates)){console.warn("Delta is missing or does not contain updates:",e);return}let t=e=>({mmsi:e,name:"unknown",latitude:null,longitude:null,sog:null,cog:null,heading:null}),a=e.context.replace("vessels.","");if(!a){console.warn("Update missing MMSI context:",e);return}r(n=>{let i=n[a]||t(a);return e.updates.forEach(e=>{e.values.forEach(e=>{switch(e.path){case"name":i.name=e.value;break;case"navigation.position":i.latitude=e.value.latitude,i.longitude=e.value.longitude;break;case"navigation.speedOverGround":i.sog=e.value;break;case"navigation.courseOverGroundTrue":i.cog=e.value;break;case"navigation.headingTrue":i.heading=e.value}})}),{...n,[a]:i}})};return(async()=>{try{let{signalkUrl:a}=d.getAll();if(console.log("SignalK URL:",a),!a)throw Error("SignalK URL is undefined or invalid.");let[n,i]=a.replace(/https?:\/\//,"").split(":");console.log("Connecting to SignalK at hostname: ".concat(n,", port: ").concat(i));let r=new h.default({hostname:n||"localhost",port:parseInt(i)||3e3,useTLS:a.startsWith("https"),reconnect:!0,autoConnect:!1,notifications:!1,subscriptions:[{context:"vessels.*",subscribe:[{path:"navigation.position"},{path:"navigation.speedOverGround"},{path:"navigation.courseOverGroundTrue"},{path:"navigation.headingTrue"}]}]});s.current=r,await r.connect(),console.log("SignalK client connected."),await e(r),r.on("delta",t)}catch(e){console.error("Error connecting to SignalK:",e)}})(),()=>{var e;console.log("Disconnecting SignalK client..."),null===(e=s.current)||void 0===e||e.disconnect()}},[]),(0,n.jsx)(eg.Provider,{value:{aisData:a,vesselIds:l},children:t})};var ev=a(5476);let eb=async e=>{try{let t=await a(9927)("./".concat(e,"/Scene.jsx"));return t.default?t.default:t.Model}catch(t){throw console.error("Error loading ".concat(e," component:"),t),t}},ej=e=>0===e?"windsurf":30===e?"optimist":36===e?"sailboat":"ship",ew=(0,i.forwardRef)((e,t)=>{let{position:a,visible:r,boatData:l}=e,[o,s]=(0,i.useState)(null),c=ej(l.shipType);if((0,i.useEffect)(()=>{let e=!0;return eb(c).then(t=>{e&&s(()=>t)}).catch(e=>console.error("Failed to load ".concat(c,":"),e)),()=>{e=!1}},[c]),!o)return null;let d=(e,t)=>"".concat(e,": ").concat(t||"N/A","\n"),u=[d("Name",l.name||"Unknown"),d("Length",l.length?"".concat(l.length,"m"):"N/A"),d("Type",l.shipType)].join(""),h=(l.length||10)/10;return(0,n.jsxs)("group",{ref:t,position:a,visible:r,children:[(0,n.jsx)(o,{scale:[h,h,h]}),(0,n.jsx)(ev.x,{position:[3,9,0],fontSize:.5,maxWidth:3,lineHeight:1,textAlign:"left",color:"white",anchorX:"center",anchorY:"top",font:"fonts/Roboto-Bold.ttf",children:u})]})});ew.displayName="AISBoat";let ey=e=>{if(e.material)return e;for(let t of e.children){let e=ey(t);if(e)return e}return null},eM=(e,t,a,n)=>({x:Math.PI/180*(t-n)*6371e3*Math.cos(Math.PI/180*a),y:Math.PI/180*(e-a)*6371e3}),eN=(e,t)=>{if(null!=e.sog&&null!=e.cog){let a=.51444*e.sog;return{deltaX:a*t*Math.sin(e.cog*Math.PI/180)*.7,deltaY:a*t*Math.cos(e.cog*Math.PI/180)*.7}}return{deltaX:0,deltaY:0}},eT=function(e,t,a){let n=!(arguments.length>3)||void 0===arguments[3]||arguments[3],i=-(.7*t),r=.7*a;n?(e.position.x+=(i-e.position.x)*.1,e.position.z+=(r-e.position.z)*.1):e.position.set(i,0,r)},eS=function(e,t){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2],n=t*Math.PI/180;a?e.children[0].rotation.y+=(n-e.children[0].rotation.y)*.1:e.children[0].rotation.y=n};var eC=()=>{let{aisData:e,vesselIds:t}=ex(),a=(0,i.useRef)({}),{getSignalKValue:r}=N();(0,K.F)(()=>{let n=r("navigation.position"),i=r("navigation.speedOverGround");if(!(null==n?void 0:n.latitude)||!(null==n?void 0:n.longitude)||!Object.keys(a.current).length)return;let l=performance.now(),o=t.length&&!Object.keys(e).length;Object.values(o?t:e).forEach(e=>{if(null==e.latitude||null==e.longitude||!a.current[e.mmsi])return;let t=a.current[e.mmsi],r=e.lastUpdate||l,{x:s,y:c}=eM(e.latitude,e.longitude,n.latitude,n.longitude),d=0,u=0;!o&&null!=i&&i>0&&l-r>1e3&&({deltaX:d,deltaY:u}=eN(e,(l-r)/1e3));let h=s+d,m=c+u,g=Math.sqrt((.7*h)**2+(.7*m)**2);if(g>0&&g<=2100){t.visible=!0,t.currentColor||(t.currentColor=g<350?"red":"white");let a=t.currentColor;"red"===t.currentColor&&g>385?a="white":"white"===t.currentColor&&g<350&&(a="red"),console.log("Boat ".concat(e.mmsi,": Displayed Distance = ").concat(g.toFixed(2),", Target Color = ").concat(a)),eT(t,h,m,!o),null!=e.cog?eS(t,e.cog,!o):null!=e.heading&&eS(t,e.heading,!o);let n=ey(t.children[0]);n?(t.redMaterial||(t.redMaterial=n.material.clone(),t.redMaterial.color.set("red")),t.whiteMaterial||(t.whiteMaterial=n.material.clone(),t.whiteMaterial.color.set("white")),"red"===a&&"red"!==t.currentMaterial?(n.material=t.redMaterial,t.currentMaterial="red",console.log("Swapped material to red for boat ".concat(e.mmsi))):"white"===a&&"white"!==t.currentMaterial&&(n.material=t.whiteMaterial,t.currentMaterial="white",console.log("Swapped material to white for boat ".concat(e.mmsi))),t.currentColor=a):console.warn("Material not found for boat ".concat(e.mmsi))}else t.visible=!1})});let l=(0,i.useMemo)(()=>t.filter(e=>e.mmsi&&!e.mmsi.startsWith("urn:mrn:signalk:uuid:")&&!e.mmsi.startsWith("227925790")&&!e.mmsi.startsWith("urn:mrn:imo:mmsi:230035780")).map(e=>(0,n.jsx)(ew,{ref:t=>a.current[e.mmsi]=t,position:[0,0,0],visible:!1,boatData:e},e.mmsi)),[t]);return(0,n.jsx)(n.Fragment,{children:l})},eE=a(1);let eR=i.memo(e=>{let{radius:t,isOuter:a,markerColorPrimary:r,markerColorGreen:l,markerColorRed:o}=e,s=(0,i.useMemo)(()=>{let e=[];for(let i=0;i<360;i+=10){let s=m.M8C.degToRad(i-90),c=i%30==0,d=a?c?.4:.2:c?.3:.15,u=(t+.5*d+.2)*Math.cos(s),h=(t+.5*d+.2)*Math.sin(s),g=a&&i>0&&i<61,x=a&&i>=300&&i<360,f=g?l:x?o:r;if(!a&&c){let t=0===i?"N":i.toString();e.push((0,n.jsx)(ev.x,{characters:"N0123456789",position:[u,.01,h],color:r,fontSize:.5,rotation:[-Math.PI/2,0,Math.PI/2-s],font:"fonts/Roboto-Bold.ttf",anchorY:"middle",children:t},"text-".concat(i)))}else e.push((0,n.jsx)(eE.aL,{args:[d/2,16,16],position:[u,0,h],children:(0,n.jsx)("meshBasicMaterial",{color:f})},"marker-".concat(a?"outer":"inner","-").concat(i)))}return e},[t,a,r,l,o]);return(0,n.jsx)(n.Fragment,{children:s})});eR.displayName="StaticMarkers";let eP=i.memo(e=>{let{innerRadius:t,outerRadius:a,dialColor:i,opacity:r=1,transparent:l=!1}=e;return(0,n.jsx)(eE.FM,{args:[t,a,64],rotation:[Math.PI/2,0,0],children:(0,n.jsx)("meshBasicMaterial",{color:i,side:m.ehD,transparent:l,opacity:r})})});eP.displayName="StaticRing";let eI=e=>{let{outerRadius:t,innerRadius:a}=e,{nightMode:r,getSignalKValue:l}=N(),o=r?"#ef4444":16777215,s=l("navigation.courseOverGroundTrue")||10,c=(0,i.useMemo)(()=>({innerRadius:a,outerRadius:t,dialColor:o,markerColorPrimary:0,markerColorGreen:p,markerColorRed:f}),[a,t,o,0,p,f]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("group",{rotation:[0,Math.PI-s,0],children:[(0,n.jsx)(eP,{innerRadius:c.innerRadius,outerRadius:c.outerRadius,dialColor:c.dialColor}),(0,n.jsx)(eR,{radius:c.innerRadius,isOuter:!1,markerColorPrimary:c.markerColorPrimary,markerColorGreen:c.markerColorGreen,markerColorRed:c.markerColorRed})]}),(0,n.jsxs)("group",{children:[(0,n.jsx)(eP,{innerRadius:c.innerRadius+1,outerRadius:c.outerRadius+1,dialColor:c.dialColor,transparent:!0,opacity:.5}),(0,n.jsx)(eR,{radius:c.innerRadius+1,isOuter:!0,markerColorPrimary:c.markerColorPrimary,markerColorGreen:c.markerColorGreen,markerColorRed:c.markerColorRed})]})]})};eI.displayName="CompassDial";var eA=a(718),e_=a.n(eA);let ek={TRUE_WIND:1,APP_WIND:1},eL=e=>{let{position:t=[0,0,0],rotation:a=[0,0,0],speed:i,color:r="#ffffff",fontSize:l=.5,textPosition:o=[0,.8,0],arrowSize:s=1}=e;return(0,n.jsxs)("group",{position:t,rotation:a,children:[(0,n.jsx)(ev.x,{characters:".0123456789",color:r,fontSize:l*s,position:o,font:"fonts/Roboto-Bold.ttf",children:i.toFixed(1)}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("shapeGeometry",{args:[new m.bnF([new m.FM8(0,0),new m.FM8(.5*s*Math.cos(5*Math.PI/6),.5*s*Math.sin(5*Math.PI/6)),new m.FM8(0,-.577*s),new m.FM8(-.5*s*Math.cos(5*Math.PI/6),.5*s*Math.sin(5*Math.PI/6)),new m.FM8(0,0)])]}),(0,n.jsx)("meshStandardMaterial",{color:r,side:m.ehD})]})]})};eL.propTypes={position:e_().instanceOf(m.Pa4).isRequired,rotation:e_().arrayOf(e_().number).isRequired,speed:e_().number.isRequired,color:e_().string.isRequired,fontSize:e_().number.isRequired,textPosition:e_().arrayOf(e_().number).isRequired};let eO=e=>{let{outerRadius:t}=e,{getSignalKValue:a}=N(),r=Math.PI/2-a("environment.wind.angleTrueGround")||0,l=b(a("environment.wind.speedOverGround"))||0,o=Math.PI/2-a("environment.wind.angleApparent")||0,s=b(a("environment.wind.speedApparent"))||0,c=(0,i.useMemo)(()=>new m.Pa4((t+.7)*Math.cos(r),0,-(t+.7)*Math.sin(r)),[t,r]),d=(0,i.useMemo)(()=>new m.Pa4((t+.7)*Math.cos(o),0,-(t+.7)*Math.sin(o)),[t,o]);return(0,n.jsxs)("group",{children:[l>0&&(0,n.jsx)(eL,{position:c,rotation:[-Math.PI/2,0,-(Math.PI/2-r)],speed:l,color:"blue",fontSize:ek.TRUE_WIND}),s>0&&(0,n.jsx)(eL,{position:d,rotation:[-Math.PI/2,0,-(Math.PI/2-o)],speed:s,color:x,fontSize:ek.APP_WIND})]})};eO.propTypes={outerRadius:e_().number.isRequired};var eF=()=>(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(eI,{outerRadius:5.6,innerRadius:5}),(0,n.jsx)(eO,{outerRadius:5.6+1.1})]}),eG=a(8181),eD=JSON.parse('{"N":{"52":[4.98,5.86,6.31,6.45,6.51,6.52,6.41],"60":[5.25,6.11,6.56,6.73,6.79,6.82,6.79],"75":[5.45,6.33,6.77,7.01,7.13,7.2,7.24],"90":[5.66,6.55,7,7.25,7.38,7.53,7.7],"110":[5.49,6.49,7.04,7.4,7.69,7.97,8.38],"120":[5.32,6.36,6.97,7.39,7.77,8.1,8.6],"135":[4.81,5.92,6.68,7.15,7.55,7.95,8.85],"150":[4.09,5.17,6.04,6.61,6.99,7.31,7.93],"angles":[52,60,75,90,110,120,135,150],"speeds":[6,8,10,12,14,16,20],"beat_angle":[43.6,42,41.2,41.2,41.7,42.1,44.2],"beat_vmg":[3.26,3.91,4.24,4.34,4.36,4.34,4.16],"run_angle":[144.8,147.8,148.5,149.6,171.8,175.4,177.2],"run_vmg":[3.54,4.48,5.23,5.73,6.17,6.67,7.36]}}');let eB={DEG2RAD:Math.PI/180,ROTATION_INTERPOLATION_FACTOR:.05,SOG_SMOOTHING_FACTOR:.1,DEFAULT_SOG:3,ANGLE_INCREMENT:10,SPHERE_SIZE:.4,SPHERE_SEGMENTS:32,DEFAULT_LINE_WIDTH:1,PLOTS_COUNT:10,FRAME_TO_MINUTE_RATIO:3600},eU=(e,t)=>26.8224*e*t*.1,ez=(e,t,a)=>{if(!e||!t)return new m.Pa4(0,0,0);let n=e*eB.DEG2RAD,i=eU(t,a);return new m.Pa4(i*Math.sin(n),0,-i*Math.cos(n))},eW=(e,t)=>{if(!(null==e?void 0:e.length))return 0;let a=0,n=e.length-1;for(;a<n;){let i=Math.floor((a+n)/2);e[i]<t?a=i+1:n=i}return a},eH=e=>{let{position:t,color:a}=e;return t?(0,n.jsxs)("mesh",{position:t,children:[(0,n.jsx)("sphereGeometry",{args:[eB.SPHERE_SIZE,eB.SPHERE_SEGMENTS,eB.SPHERE_SEGMENTS]}),(0,n.jsx)("meshStandardMaterial",{color:a})]}):null},eV=e=>{let{points:t,color:a}=e;return(null==t?void 0:t.length)?(0,n.jsx)(eG.x,{points:t,color:a,lineWidth:eB.DEFAULT_LINE_WIDTH}):null},eY=i.memo(e=>{let{timeInMinute:t,windSpeed:a}=e,r=(0,i.useRef)(eD.N),l=(0,i.useCallback)((e,t,a,n)=>(null==e?void 0:e.length)&&(null==t?void 0:t.length)&&!(e.length<=a)&&!(t.length<=a)?ez(e[a],t[a],n):(console.warn("Invalid angle or VMG data"),null),[]),o=(0,i.useCallback)((e,t)=>{let{speeds:a,angles:n,beat_angle:i,beat_vmg:l,run_angle:o,run_vmg:s}=r.current;if(!(null==a?void 0:a.length)||!(null==n?void 0:n.length))return console.warn("Invalid polar data"),null;let c=(e,t,a)=>e+a*(t-e),d=[],u=(e,a,n)=>{for(let i=e;i<=a;i+=eB.ANGLE_INCREMENT)d.push(ez(i,n(i),t))};return u(0,i[e],t=>c(0,l[e],t/i[e])),n.forEach(a=>{if(a>i[e]&&a<o[e]){var n;let i=(null===(n=r.current[Math.floor(a)])||void 0===n?void 0:n[e])||0;d.push(ez(a,i,t))}}),u(o[e],180,()=>s[e]),new m.YT8(d,!0)},[]),s=(0,i.useMemo)(()=>{var e;let n=r.current;if(!(null==n?void 0:null===(e=n.speeds)||void 0===e?void 0:e.length))return console.warn("Invalid polar data structure"),{curve:null,beat:null,run:null};let i=eW(n.speeds,a);return{curve:o(i,t),beat:l(n.beat_angle,n.beat_vmg,i,t),run:l(n.run_angle,n.run_vmg,i,t)}},[t,a,l,o]);return(0,n.jsx)(n.Fragment,{children:[0,-Math.PI].map((e,t)=>(0,n.jsxs)("group",{rotation:[0,0,e],children:[s.curve&&(0,n.jsx)(eV,{points:s.curve.getPoints(100),color:x}),(0,n.jsx)(eH,{position:s.beat,color:p}),(0,n.jsx)(eH,{position:s.run,color:f})]},t))})});eY.displayName="PolarPlot";var eK=function(){let e=(0,i.useRef)([]),[t,a]=(0,i.useState)([]),r=(0,i.useRef)(0),l=(0,i.useRef)([]),o=(0,i.useRef)(eB.DEFAULT_SOG),{getSignalKValue:s}=N(),c=s("environment.wind.angleApparent"),d=b(s("environment.wind.speedOverGround"))||0,u=s("navigation.speedOverGround")||eB.DEFAULT_SOG;return(0,i.useEffect)(()=>{let t=Array.from({length:eB.PLOTS_COUNT},(e,t)=>({id:t,timeInMinute:5*(t+1)}));a(t),e.current=t.map(()=>new m.ZAu),l.current=Array(eB.PLOTS_COUNT).fill(0)},[]),(0,K.F)((a,n)=>{r.current+=1,o.current=m.M8C.lerp(o.current,u,eB.SOG_SMOOTHING_FACTOR),t.forEach((t,a)=>{let n=e.current[a];if(n&&t.timeInMinute-r.current/eB.FRAME_TO_MINUTE_RATIO>0){let e=l.current[a],t=m.M8C.lerp(e,c,eB.ROTATION_INTERPOLATION_FACTOR);n.rotation.set(0,t,0),l.current[a]=t}})}),(0,n.jsx)(n.Fragment,{children:t.map((t,a)=>(0,n.jsx)("group",{ref:t=>{t&&(e.current[a]=t)},children:(0,n.jsx)(eY,{timeInMinute:t.timeInMinute,windSpeed:d})},t.id))})},eX=()=>{let{states:e}=N(),t=(0,i.useRef)();return(0,n.jsxs)(i.Suspense,{fallback:(0,n.jsx)(W.V,{children:"Loading..."}),children:[(0,n.jsx)(H.c,{makeDefault:!0,fov:60,near:1,far:1e3,position:[0,5,20]}),(0,n.jsx)(V.z,{enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/4}),(0,n.jsx)(Y.qA,{files:"./assets/ocearo_env.hdr",background:!1,intensity:.8}),(0,n.jsx)("ambientLight",{intensity:.6}),(0,n.jsx)("spotLight",{position:[15,30,20],intensity:2,angle:Math.PI/6,penumbra:.5,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":.5,"shadow-camera-far":50,"shadow-bias":-.0001}),(0,n.jsx)("directionalLight",{position:[-10,20,10],intensity:1.5,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":.5,"shadow-camera-far":50,"shadow-bias":-.0001,color:"#ffd1a6"}),(0,n.jsx)("directionalLight",{position:[10,10,-10],intensity:.3}),(0,n.jsx)("pointLight",{position:[-10,10,-10],intensity:.7}),(0,n.jsxs)("group",{position:[0,-3,0],children:[(0,n.jsx)(ec,{position:[0,0,.7],scale:[.7,.7,.7],ref:t,showSail:!0}),e.showOcean&&(0,n.jsx)(em,{}),(0,n.jsx)(eu,{}),(0,n.jsx)(eK,{}),e.ais&&(0,n.jsx)(ep,{children:(0,n.jsx)(eC,{})}),(0,n.jsx)(eF,{visible:!1})]})]})},eq=()=>{let{nightMode:e,setNightMode:t,states:a,toggleState:i}=N(),r=e?"text-oNight":"text-oGray",l=e=>{let t={autopilot:"autopilot"===e,anchorWatch:"anchorWatch"===e,parkingMode:"parkingMode"===e};Object.keys(t).forEach(e=>{i(e,t[e])})};return(0,n.jsxs)("div",{className:"text-lg",children:[(0,n.jsx)("button",{onClick:()=>l("autopilot"),className:"p-1",children:(0,n.jsx)(I.G,{icon:A.lnS,className:a.autopilot?"text-oBlue":r})}),(0,n.jsx)("button",{onClick:()=>l("anchorWatch"),className:"p-1",children:(0,n.jsx)(I.G,{icon:A.SJR,className:a.anchorWatch?"text-oYellow":r})}),(0,n.jsx)("button",{onClick:()=>l("parkingMode"),className:"p-1",children:(0,n.jsx)(I.G,{icon:A.BQ9,className:a.parkingMode?"text-oGreen":r})}),(0,n.jsx)("button",{onClick:()=>t(!e),className:"p-1",children:(0,n.jsx)(I.G,{icon:A.DBF,className:e?"text-oNight":r})}),(0,n.jsx)("button",{onClick:()=>i("showOcean"),className:"p-1",children:(0,n.jsx)(I.G,{icon:A.L02,className:a.showOcean?"text-oBlue":r})}),(0,n.jsx)("button",{onClick:()=>i("ais"),className:"p-1",children:(0,n.jsx)(I.G,{icon:A.mDh,className:a.ais?"text-oGreen":r})})]})};let eZ={SOG:"navigation.speedOverGround",VMG:"performance.velocityMadeGood",STW:"navigation.speedThroughWater",POL:"performance.polarSpeedRatio"};var eJ=()=>{let{nightMode:e,getSignalKValue:t}=N(),[a,r]=(0,i.useState)("SOG"),l=(0,i.useMemo)(()=>{let e={};for(let[a,n]of Object.entries(eZ)){let i=t(n);null!=i&&(e[a]=b(i))}return e},[t]),o=Object.keys(l),s=void 0!==l[a]?a:o[0],c=l[s],d=(0,i.useCallback)(()=>{if(0===o.length)return;let e=(o.indexOf(s)+1)%o.length;r(o[e])},[o,s]),u=e?"text-oNight":"text-oGray";return 0===o.length?(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("div",{className:"text-6xl font-bold text-gray-400",children:"--"}),(0,n.jsx)("div",{className:"text-lg ".concat(u),children:"NO DATA"})]}):(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsx)("div",{className:"text-6xl font-bold cursor-pointer ".concat(e?"text-oNight":"text-white"),onClick:d,role:"button",tabIndex:0,"aria-label":"Current speed: ".concat(c," ").concat(s,". Click to change speed type."),children:(null==c?void 0:c.toFixed(1))||"--"}),(0,n.jsx)("div",{className:"text-lg ".concat(u),children:s})]})};let eQ={BATTERIES:"batteries",TANKS:"tanks"},e$={FRESH_WATER:{id:"freshWater",label:"Fresh Water",path:"tanks.freshWater.0.currentLevel",icon:"\uD83D\uDCA7",color:"bg-oBlue"},FUEL:{id:"fuel",label:"Fuel",path:"tanks.fuel.0.currentLevel",icon:"⛽",color:"bg-oYellow"},BLACK_WATER:{id:"blackWater",label:"Black Water",path:"tanks.blackWater.0.currentLevel",icon:"\uD83D\uDEB0",color:"bg-oGray"}},e0=e=>{let{level:t,type:a}=e,i=Math.max(0,Math.min(100,t)),{label:r,icon:l,color:o}=e$[a];return(0,n.jsxs)("div",{className:"flex items-center space-x-3 my-2",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,n.jsx)("span",{className:"text-sm",children:l}),(0,n.jsx)("div",{className:"relative w-20 h-4 bg-oGray rounded-lg overflow-hidden",children:(0,n.jsx)("div",{className:"absolute left-0 top-0 h-full ".concat(o," transition-all duration-300"),style:{width:"".concat(i,"%")}})})]}),(0,n.jsxs)("span",{className:"text-sm font-medium",children:[r,": ",i,"%"]})]})},e1=e=>{let{batteryLevel:t,batteryNumber:a,voltage:r}=e,[l,o]=(0,i.useState)(!1),s=Math.max(0,Math.min(100,t)),c=r>j.CHARGING_THRESHOLD,d=(0,i.useMemo)(()=>s>j.WARNING_THRESHOLD?"bg-oGreen":s>j.DANGER_THRESHOLD?"bg-oYellow":"bg-oRed",[s]);return(0,n.jsxs)("div",{className:"flex items-center space-x-3 my-2 relative",onMouseEnter:()=>o(!0),onMouseLeave:()=>o(!1),children:[(0,n.jsxs)("div",{className:"relative w-8 h-4 bg-oGray rounded-sm border border-oGray flex items-center justify-center",children:[(0,n.jsx)("div",{className:"absolute -right-1 w-1 h-3 bg-oGray rounded-sm"}),(0,n.jsx)("div",{className:"absolute left-0 top-0 h-full ".concat(d," transition-all duration-300 rounded-sm"),style:{width:"".concat(s,"%")}}),(0,n.jsx)("span",{className:"relative z-10 text-xs text-black font-bold",children:a})]}),(0,n.jsxs)("span",{className:"text-sm font-medium ".concat(s<=j.DANGER_THRESHOLD?"text-oRed animate-pulse":""),children:[s,"%"]}),c&&(0,n.jsx)("span",{className:"text-oGreen ml-1",children:"⚡"}),l&&(0,n.jsxs)("div",{className:"absolute -left-20 top-10 bg-gray-800 text-white px-2 py-1 rounded text-xs whitespace-nowrap",children:["Voltage: ",null==r?void 0:r.toFixed(1),"V ",c&&"(Charging)"]})]})};var e2=()=>{let{nightMode:e,getSignalKValue:t}=N(),[a,r]=(0,i.useState)(eQ.BATTERIES),l=(0,i.useMemo)(()=>{let e=t("electrical.batteries.1.capacity.stateOfCharge"),a=t("electrical.batteries.1.voltage");return[{level:null===e?w(a):e,number:1,voltage:a}].filter(e=>null!==e.level)},[t]),o=(0,i.useMemo)(()=>({FRESH_WATER:t(e$.FRESH_WATER.path)||40,FUEL:t(e$.FUEL.path)||75,BLACK_WATER:t(e$.BLACK_WATER.path)||20}),[t]),s=()=>{r(e=>e===eQ.BATTERIES?eQ.TANKS:eQ.BATTERIES)};return(0,n.jsx)("div",{className:"".concat(e?"text-oNight":"text-oGray"," rounded-lg transition-all duration-300 hover:bg-gray-800/10 cursor-pointer"),onClick:s,role:"button",tabIndex:0,"aria-label":"Toggle between ".concat(a===eQ.BATTERIES?"tanks":"batteries"," display"),onKeyPress:e=>"Enter"===e.key&&s(),children:a===eQ.BATTERIES?(0,n.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,n.jsx)(e1,{batteryLevel:e.level,batteryNumber:e.number,voltage:e.voltage},e.number))}):(0,n.jsx)("div",{className:"space-y-2",children:Object.entries(e$).map(e=>{let[t,a]=e;return(0,n.jsx)(e0,{type:t,level:o[t]},t)})})})},e5=()=>{let{nightMode:e}=N(),{getSignalKValue:t}=N(),a=180*(t("steering.rudderAngle")||0)/Math.PI;return(0,n.jsx)("div",{style:{width:"480px",paddingBottom:"25px"},className:"mx-auto",children:(0,n.jsxs)("div",{className:"w-full bg-oGray h-1 rounded-full relative  mt-2",children:[(()=>{let t=[];for(let a=-60;a<=60;a+=10){let i=a/120*100;t.push((0,n.jsx)("div",{className:"absolute h-2 w-px bg-oGray",style:{left:"".concat(50+i,"%"),transform:"translateX(-20%)"},children:(0,n.jsx)("span",{className:"text-xs ".concat(e?"text-oNight":"text-oGray"),style:{transform:"translateY(-50%)"},children:a})},a))}return t})()," ",(0,n.jsx)("div",{className:"absolute top-0 h-1 rounded-full transition-all duration-300 ease-in-out ".concat(a<0?"bg-oRed":"bg-oGreen"),style:{width:"".concat(Math.abs(a)/120*100,"%"),left:"50%",transform:a<0?"translateX(-100%)":"translateX(0)"}})]})})};let e4={MIN:10,MAX:90},e3={RISING:{BACKGROUND:"bg-oGreen",TEXT:"text-oGreen"},FALLING:{BACKGROUND:"bg-oYellow",TEXT:"text-oYellow"}},e6={NIGHT:"text-oNight",DAY:"text-white"};var e7=()=>{let{nightMode:e,getSignalKValue:t}=N(),[a,r]=(0,i.useState)(240),[l,o]=(0,i.useState)({level:null,high:null,low:null,timeLow:null,timeHigh:null,coefficient:null,isRising:null}),s=(0,i.useCallback)(e=>{if(!e)return null;let[t,a]=e.split(":").map(Number);return 60*t+a},[]),c=(0,i.useCallback)((e,t,a)=>{let n=s(e),i=s(t),r=s(a);return!!n&&!!i&&!!r&&(i<r?n>=i&&n<=r:n>=i||n<=r)},[s]),d=(0,i.useCallback)((e,t,a)=>a<=t||!e?0:Math.min(100,Math.max(0,(e-t)/(a-t)*100)),[]);(0,i.useEffect)(()=>{let e=()=>{let e=window.innerHeight;r(e<640?Math.min(.25*e,240):Math.min(.35*e,240))};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{let e=new Date().toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1}),a={level:t("environment.tide.heightNow"),high:t("environment.tide.heightHigh"),low:t("environment.tide.heightLow"),timeLow:t("environment.tide.timeLow"),timeHigh:t("environment.tide.timeHigh"),coefficient:t("environment.tide.coeffNow")};Object.values(a).every(e=>null!=e)&&o({...a,isRising:c(e,a.timeLow,a.timeHigh)})},[t,c]);let{level:u,high:h,low:m,timeLow:g,timeHigh:x,coefficient:f,isRising:p}=l,v=e?e6.NIGHT:e6.DAY,b=p?e3.RISING:e3.FALLING,j=(0,i.useMemo)(()=>d(u,m,h),[u,m,h,d]);if(Object.values(l).some(e=>null===e))return null;let w=j>e4.MIN&&j<e4.MAX;return(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("div",{className:"text-sm ".concat(v),children:"La Rochelle"}),(0,n.jsxs)("div",{className:"text-sm mb-2 ".concat(v," flex items-center gap-1"),children:[x,(0,n.jsx)("span",{className:"inline-block transform ".concat(!p&&"rotate-180"," ").concat(b.TEXT),children:"▲"}),(0,n.jsx)("span",{children:f})]}),(0,n.jsxs)("div",{className:"relative flex flex-col w-8",style:{height:a},children:[(0,n.jsxs)("span",{className:"absolute ".concat(v," text-sm font-medium"),style:{top:"0%",left:"60%"},children:[h,"m"]}),w&&(0,n.jsxs)("span",{className:"absolute ".concat(v," text-sm font-medium transition-opacity duration-300"),style:{bottom:"".concat(j,"%"),left:"60%"},children:[u.toFixed(2),"m"]}),(0,n.jsxs)("span",{className:"absolute ".concat(v," text-sm font-medium"),style:{bottom:"0%",left:"60%"},children:[m,"m"]}),(0,n.jsx)("div",{className:"flex flex-col justify-end bg-oGray rounded-3xl w-2 overflow-hidden",style:{height:a},children:(0,n.jsx)("div",{role:"progressbar",className:"".concat(b.BACKGROUND," w-2 rounded-3xl transition-all duration-500"),"aria-valuenow":j,"aria-valuemin":"0","aria-valuemax":"100","aria-label":"Tide level: ".concat(u.toFixed(2)," meters"),style:{height:"".concat(j,"%")}})})]}),(0,n.jsx)("div",{className:"text-sm mt-2 ".concat(v),children:g})]})};let e8={MOBILE_TEMPLATE:{COLOR:"yellow",WIDTH_FACTOR:.8,LENGTH_FACTOR:2.5,MAX_LENGTH_MULTIPLIER:3.5,CURVATURE_SENSITIVITY:{RUDDER:1.5,WIND:.25,CURRENT:.3,LEEWAY:.15,DRIFT:.1}},NEUTRAL_TEMPLATE:{COLOR:"blue",WIDTH_FACTOR:.7,LENGTH_FACTOR:.9},ANTICOLLISION_TEMPLATE:{COLOR:"red",WIDTH_FACTOR:1.5,LENGTH_FACTOR:.8}};var e9=e=>{let{rudderAngle:t=0,sog:a=5,boatWidth:r=2,windSpeed:l=0,windDirection:o=0,currentSpeed:s=0,currentDirection:c=0,leewayAngle:d=0,driftFactor:u=0,maxCurvePoints:h=50}=e,g=(0,i.useRef)(),x=(0,i.useRef)(),f=(0,i.useRef)(),p=(0,i.useCallback)(()=>{let e=e=>m.M8C.degToRad(e),t=e(o),a=e(d),n=Math.cos(t+a)*l*e8.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.WIND,i=Math.sin(t+a)*l*e8.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.WIND,r=e(c),h=Math.cos(r)*s*e8.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.CURRENT,g=Math.sin(r)*s*e8.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.CURRENT;return{x:(n+h)*(1+u*e8.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.DRIFT),z:(i+g)*(1+u*e8.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.DRIFT)}},[l,o,s,c,d,u]),v=(0,i.useCallback)(()=>{let e=r*e8.MOBILE_TEMPLATE.MAX_LENGTH_MULTIPLIER,a=Math.min(2*r*e8.MOBILE_TEMPLATE.LENGTH_FACTOR,e),n=[],i=1.5*p().x;if(.1>Math.abs(t)){let e=.5*i,t=Math.max(r/Math.tan(m.M8C.degToRad(5+Math.abs(e))),.5*r),l=a/t,o=new m.FM8(e>0?t:-t,0),s=e>0?Math.PI:0;for(let a=0;a<=h;a++){let i=s+a/h*(e>0?l:-l),r=o.x+t*Math.cos(i),c=o.y+t*Math.sin(i);n.push(new m.Pa4(r,0,c))}}else{let e=m.M8C.clamp(1.2*Math.abs(t)+i,0,85),l=r/Math.tan(m.M8C.degToRad(e*e8.MOBILE_TEMPLATE.CURVATURE_SENSITIVITY.RUDDER)),o=m.M8C.clamp(a/l,0,1.25*Math.PI);if(t>0){let e=new m.FM8(l,0),t=Math.PI;for(let a=0;a<=h;a++){let i=a/h,r=m.M8C.lerp(t,t+o,i),s=e.x+l*Math.cos(r),c=e.y+l*Math.sin(r);n.push(new m.Pa4(s,0,c))}}else{let e=new m.FM8(-l,0);for(let t=0;t<=h;t++){let a=t/h,i=m.M8C.lerp(0,0-o,a),r=e.x+l*Math.cos(i),s=e.y+l*Math.sin(i);n.push(new m.Pa4(r,0,s))}}}let l=n.map((e,t)=>{let a;(a=0===t?n[1].clone().sub(e):e.clone().sub(n[t-1])).normalize();let i=new m.Pa4(-a.z,0,a.x),l=r/1.8;return{left:e.clone().add(i.multiplyScalar(l)),right:e.clone().sub(i.multiplyScalar(l))}});return[...l.map(e=>e.left),l[l.length-1].right,...l.reverse().map(e=>e.right)]},[r,t,h,p]),b=(0,i.useCallback)(e=>{if("MOBILE_TEMPLATE"===e)return v();let t=e8[e],a=2*r*t.LENGTH_FACTOR,n=r*t.WIDTH_FACTOR,i=[],l=Math.floor(h/4);for(let e=0;e<=l;e++){let t=e/l;i.push(new m.Pa4(-n/2,0,-a*t))}i.push(new m.Pa4(n/2,0,-a));for(let e=l;e>=0;e--){let t=e/l;i.push(new m.Pa4(n/2,0,-a*t))}return i},[r,h,v]);return(0,i.useEffect)(()=>{g.current&&x.current&&f.current&&(g.current.geometry.setFromPoints(b("MOBILE_TEMPLATE")),x.current.geometry.setFromPoints(b("NEUTRAL_TEMPLATE")),f.current.geometry.setFromPoints(b("ANTICOLLISION_TEMPLATE")))},[b]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("line",{ref:g,children:[(0,n.jsx)("bufferGeometry",{}),(0,n.jsx)("lineBasicMaterial",{color:e8.MOBILE_TEMPLATE.COLOR,linewidth:2})]}),(0,n.jsxs)("line",{ref:x,children:[(0,n.jsx)("bufferGeometry",{}),(0,n.jsx)("lineBasicMaterial",{color:e8.NEUTRAL_TEMPLATE.COLOR,linewidth:2})]}),(0,n.jsxs)("line",{ref:f,children:[(0,n.jsx)("bufferGeometry",{}),(0,n.jsx)("lineBasicMaterial",{color:e8.ANTICOLLISION_TEMPLATE.COLOR,linewidth:2})]})]})};let te=e=>{let{position:t,rotation:a,speed:i,color:r="#ffffff",fontSize:l=.5,textPosition:o=[0,.8,0],arrowSize:s=1}=e;return(0,n.jsxs)("group",{position:t,rotation:a,children:[(0,n.jsx)(ev.x,{characters:"0123456789.",color:r,fontSize:l*s,position:o,font:"fonts/Roboto-Bold.ttf",anchorX:"center",anchorY:"middle",children:i.toFixed(1)}),(0,n.jsxs)("mesh",{children:[(0,n.jsx)("shapeGeometry",{args:[new m.bnF([new m.FM8(0,0),new m.FM8(.5*s*Math.cos(5*Math.PI/6),.5*s*Math.sin(5*Math.PI/6)),new m.FM8(0,-.577*s),new m.FM8(-.5*s*Math.cos(5*Math.PI/6),.5*s*Math.sin(5*Math.PI/6)),new m.FM8(0,0)])]}),(0,n.jsx)("meshStandardMaterial",{color:r,side:m.ehD})]})]})};te.propTypes={position:e_().arrayOf(e_().number),rotation:e_().arrayOf(e_().number),speed:e_().number.isRequired,color:e_().string,fontSize:e_().number,textPosition:e_().arrayOf(e_().number),arrowSize:e_().number},te.defaultProps={position:[0,0,0],rotation:[0,0,0],color:"#ffffff",fontSize:.5,textPosition:[0,.8,0],arrowSize:1};let tt=e=>{let{outerRadius:t}=e,{getSignalKValue:a}=N(),r=a("environment.current")||{setTrue:0,drift:0},l=(0,i.useMemo)(()=>{let e=r.setTrue||0;return[(t+.7)*Math.cos(e),0,-(t+.7)*Math.sin(e)]},[t,r.setTrue]);return!r.drift||r.drift<=0?null:(0,n.jsx)("group",{children:(0,n.jsx)(te,{position:l,rotation:[-Math.PI/2,0,-(Math.PI/2-(r.setTrue||0))],speed:r.drift,color:p,arrowSize:1.2})})};tt.propTypes={outerRadius:e_().number.isRequired};var ta=()=>{let e=(0,i.useRef)(),{getSignalKValue:t}=N(),a=t("steering.rudderAngle")||0,r=t("navigation.speedOverGround")||0,l=t("environment.wind.angleApparent")||0,o=b(t("environment.wind.speedApparent"))||0,s=t("environment.current")||{setTrue:0,drift:0};return(0,n.jsxs)(i.Suspense,{fallback:(0,n.jsx)(W.V,{center:!0,children:"Loading..."}),children:[(0,n.jsx)(H.c,{makeDefault:!0,fov:60,near:1,far:1e3,position:[0,1,10]}),(0,n.jsx)(V.z,{enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/4}),(0,n.jsx)(Y.qA,{files:"./assets/ocearo_env.hdr",background:!1,intensity:.8}),(0,n.jsx)("ambientLight",{intensity:.6}),(0,n.jsx)("spotLight",{position:[15,30,20],intensity:1.8,angle:Math.PI/6,penumbra:.5,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":.5,"shadow-camera-far":50,"shadow-bias":-.0001}),(0,n.jsx)("directionalLight",{position:[-10,20,10],intensity:1.5,castShadow:!0,"shadow-mapSize-width":1024,"shadow-mapSize-height":1024,"shadow-camera-near":.5,"shadow-camera-far":50,"shadow-bias":-.0001,color:"#ffd1a6"}),(0,n.jsx)("pointLight",{position:[-10,10,-10],intensity:.7}),(0,n.jsxs)("group",{position:[0,-3,0],children:[(0,n.jsx)(ec,{position:[0,0,.7],scale:[.5,.5,.5],ref:e,showSail:!1}),(0,n.jsx)(eO,{outerRadius:5}),(0,n.jsx)(tt,{outerRadius:5}),(0,n.jsx)("group",{position:[0,0,-5],children:(0,n.jsx)(e9,{rudderAngle:a,sog:r,windSpeed:o,windDirection:l,currentSpeed:s.drift,currentDirection:s.setTrue,boatWidth:2,leewayAngle:Math.min(Math.sin(Math.abs(l*Math.PI/180))*o*.02,10),driftFactor:r<.1?0:Math.min(s.drift/r,1),maxCurvePoints:100})})]})]})};let tn=(e,t,a,n)=>{let i=(a-e)*Math.PI/180,r=(n-t)*Math.PI/180,l=Math.sin(i/2)*Math.sin(i/2)+Math.cos(e*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(r/2)*Math.sin(r/2);return 2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l))*6371e3};var ti=()=>{let e=(0,i.useRef)(),[t,a]=(0,i.useState)(null),{getSignalKValue:r}=N();return(0,i.useEffect)(()=>{let e=r("navigation.position");e&&!t&&a({latitude:e.latitude,longitude:e.longitude})},[r,t]),(0,i.useEffect)(()=>{if(e.current){let t=new m.u9r,a=[];for(let e=0;e<=64;e++){let t=e/64*Math.PI*2;a.push(50*Math.cos(t),0,50*Math.sin(t))}t.setAttribute("position",new m.a$l(a,3)),e.current.geometry=t}},[]),(0,K.F)(()=>{if(e.current&&t){let a=r("navigation.position");if(a){let n=tn(t.latitude,t.longitude,t.latitude,a.longitude),i=tn(t.latitude,t.longitude,a.latitude,t.longitude),r=a.longitude>t.longitude?n:-n,l=a.latitude>t.latitude?i:-i;e.current.position.set(r,-6.9,l)}}}),(0,n.jsx)("line",{ref:e,children:(0,n.jsx)("lineBasicMaterial",{attach:"material",color:"green",linewidth:2})})},tr=()=>{let e=(0,i.useRef)(),{size:t}=(0,K.D)(),a=t.width/t.height;return(0,n.jsxs)(i.Suspense,{fallback:(0,n.jsx)(W.V,{children:"Loading..."}),children:[(0,n.jsx)(H.c,{makeDefault:!0,fov:25,aspect:a,near:1,far:1e3,position:[32,10,-32]}),(0,n.jsx)(V.z,{enableZoom:!0,enableRotate:!0,maxPolarAngle:Math.PI/2,minPolarAngle:Math.PI/4}),(0,n.jsx)(Y.qA,{files:"./assets/ocearo_env.hdr",background:!1}),(0,n.jsx)("ambientLight",{intensity:.6}),(0,n.jsx)("spotLight",{position:[15,30,20],intensity:2,angle:Math.PI/6,penumbra:.5,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048}),(0,n.jsx)("directionalLight",{position:[-10,20,10],intensity:1.5,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048}),(0,n.jsx)("pointLight",{position:[-10,10,-10],intensity:.7}),(0,n.jsx)(ec,{ref:e,scale:[1.3,1.3,1.3],position:[0,-6,0]}),(0,n.jsx)(ti,{}),(0,n.jsxs)("mesh",{rotation:[-Math.PI/2,0,0],position:[0,-7,0],receiveShadow:!0,children:[(0,n.jsx)("planeGeometry",{args:[100,100]}),(0,n.jsx)("shaderMaterial",{uniforms:{uColor:{value:new m.Ilk("#111111")},uBlurRadius:{value:.1}},vertexShader:"\n                            varying vec2 vUv;\n                            void main() {\n                                vUv = uv;\n                                gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n                            }\n                        ",fragmentShader:"\n                            uniform vec3 uColor;\n                            uniform float uBlurRadius;\n                            varying vec2 vUv;\n\n                            void main() {\n                                float distanceToCenter = length(vUv - vec2(0.5));\n                                float alpha = smoothstep(0.5 - uBlurRadius, 0.5 + uBlurRadius, distanceToCenter);\n                                gl_FragColor = vec4(uColor, 1.0 - alpha);\n                            }\n                        "})]})]})},tl=()=>{let{nightMode:e,getSignalKValue:t}=N(),a=t("navigation.position"),i=(e,t)=>{if(null==e)return"--";let a=Math.abs(e),n=Math.floor(a),i=((a-n)*60).toFixed(3);return"".concat(n,"\xb0").concat(i,"'").concat(t?e>=0?"N":"S":e>=0?"E":"W")};return(0,n.jsxs)("div",{className:"mt-4",children:[(0,n.jsxs)("div",{className:"text-3xl font-bold cursor-pointer flex gap-2 ".concat(e?"text-oNight":"text-white"),children:[(0,n.jsx)("span",{children:i(a.latitude,!0)}),(0,n.jsx)("span",{children:i(a.longitude,!1)})]}),(0,n.jsx)("div",{className:"text-lg ".concat(e?"text-oNight":"text-oGray"),children:(()=>{let e=new Date;try{let t=navigator.language||"en-US";return e.toLocaleString(t,{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:void 0})}catch(t){return console.warn("Error formatting date with user locale, falling back to en-US",t),e.toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!0})}})()})]})};let to={DANGER:3,WARNING:5,MAX_DEPTH:50},ts={DANGER:"bg-oRed",WARNING:"bg-oYellow",SAFE:"bg-oBlue"},tc={NIGHT:"text-oNight",DAY:"text-white"};var td=()=>{let{nightMode:e,getSignalKValue:t}=N(),[a,r]=(0,i.useState)(null),[l,o]=(0,i.useState)(240);(0,i.useEffect)(()=>{let e=()=>{let e=window.innerHeight;o(e<640?Math.min(.25*e,240):Math.min(.35*e,240))};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{let e=t("environment.depth.belowTransducer");r(null!=e?Number(e.toFixed(1)):null)},[t]);let s=(0,i.useMemo)(()=>null===a?0:Math.min(a/to.MAX_DEPTH*100,100),[a]),c=(0,i.useMemo)(()=>null===a?ts.SAFE:a<to.DANGER?ts.DANGER:a<to.WARNING?ts.WARNING:ts.SAFE,[a]),d=e?tc.NIGHT:tc.DAY,u=(0,i.useCallback)(e=>null===e?"--":"".concat(e," m"),[]);return(0,n.jsxs)("div",{className:"flex flex-col items-center",children:[(0,n.jsx)("div",{className:"text-sm mb-2 ".concat(d),children:"Depth"}),(0,n.jsx)(()=>(0,n.jsx)("div",{className:"w-2 ".concat(c," rounded-lg overflow-hidden mb-4"),style:{height:l},role:"progressbar","aria-valuenow":a,"aria-valuemin":"0","aria-valuemax":to.MAX_DEPTH,"aria-label":"Water depth: ".concat(u(a)),children:(0,n.jsx)("div",{className:"bg-oGray transition-all duration-500 ease-in-out",style:{height:"".concat(100-s,"%")}})}),{}),(0,n.jsx)("div",{className:"text-sm mt-2 ".concat(d," ").concat(a<to.DANGER?"animate-pulse":""),children:u(a)})]})},tu=()=>{let{states:e}=N();return(0,n.jsxs)("div",{className:"w-full h-full relative ",children:[(0,n.jsxs)("div",{className:"absolute top-2 left-2 z-10 space-y-0",children:[(0,n.jsx)(eq,{}),!e.anchorWatch&&(0,n.jsx)(eJ,{}),e.anchorWatch&&(0,n.jsx)(tl,{})]}),(0,n.jsx)("div",{className:"absolute top-2  z-10  right-2",children:(0,n.jsx)(e2,{})}),(0,n.jsx)("div",{className:"absolute left-2 bottom-2 z-20 flex flex-col items-center",children:(0,n.jsx)(td,{})}),(0,n.jsx)("div",{className:"absolute right-2 bottom-2 z-20 flex flex-col items-center",children:(0,n.jsx)(e7,{})}),!e.anchorWatch&&(0,n.jsx)("div",{className:"absolute bottom-2 left-1/2 transform -translate-x-1/2 z-10",children:(0,n.jsx)(e5,{})}),(0,n.jsx)("div",{className:"absolute left-1/2 transform -translate-x-1/2 w-full h-full",children:(0,n.jsx)(z.Xz,{style:{width:"100%",height:"100%"},shadows:!1,dpr:[1,1],gl:{antialias:!0,physicallyCorrectLights:!1,toneMapping:m.EoG,toneMappingExposure:1},children:e.parkingMode?(0,n.jsx)(ta,{}):e.anchorWatch?(0,n.jsx)(tr,{}):(0,n.jsx)(eX,{})})})]})};class th extends i.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),console.error("Error caught in Error Boundary:",e,t)}render(){if(this.state.hasError){let{error:e,errorInfo:t}=this.state;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 text-gray-900",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-red-600 mb-4",children:"Something went wrong."}),(0,n.jsxs)("p",{className:"text-lg mb-2",children:[(0,n.jsx)("strong",{children:"Error:"})," ",e?e.toString():"Unknown error"]}),t&&(0,n.jsxs)("details",{className:"whitespace-pre-wrap bg-gray-200 p-4 rounded-lg mb-4",children:[(0,n.jsx)("summary",{className:"cursor-pointer text-blue-500 underline",children:"Stack Trace"}),(0,n.jsx)("pre",{className:"mt-2",children:t.componentStack})]}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)("button",{onClick:this.handleRefresh,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Refresh Page"}),(0,n.jsx)("button",{onClick:this.handleExitFullscreen,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Exit Fullscreen"})]})]})}return this.props.children}constructor(e){super(e),this.handleRefresh=()=>{window.location.reload()},this.handleExitFullscreen=()=>{document.fullscreenElement&&(window.close(),document.exitFullscreen().catch(e=>{console.error("Failed to exit fullscreen:",e)}))},this.state={hasError:!1,error:null,errorInfo:null}}}let tm={BOAT:"boat",APP:"app",SPLIT:"split"},tg=()=>window.innerWidth>=1366;function tx(){let e=(0,i.useRef)(!1),[t,a]=(0,i.useState)(null),[r,o]=(0,i.useState)("navigation"),[s,c]=(0,i.useState)(!1),[d,u]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let t;a(tg()?tm.SPLIT:tm.BOAT),e.current=!0;let n=()=>{clearTimeout(t),t=setTimeout(()=>{a(tg()?tm.SPLIT:tm.BOAT)},250)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),clearTimeout(t)}},[]);let h=(0,i.useCallback)(()=>{c(e=>!e)},[]),m=(0,i.useCallback)(e=>{a(e)},[]),g=(0,i.useCallback)((e,t)=>{let a=window.innerWidth/5;t.x>a?m(tm.BOAT):t.x<-a?m(tm.APP):m(tm.SPLIT)},[m]),x=(0,i.useCallback)(()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(e=>{console.error("Fullscreen error:",e.message)})},[]),f=(0,i.useCallback)(e=>{t===tm.BOAT&&m(tm.APP),o(e)},[t,m]),p=(0,i.useCallback)(()=>{d?(m(tm.BOAT),u(!1)):(f("settings"),u(!0))},[d,m,f]),v=(0,i.useMemo)(()=>null===t?{}:{leftPane:"transition-all duration-300 ".concat(t===tm.BOAT?"w-full":t===tm.APP?"hidden":"w-2/5"," bg-leftPaneBg h-full relative"),rightPane:"transition-all duration-300 ".concat(t===tm.APP?"w-full":t===tm.BOAT?"hidden":"w-3/5"," h-full bg-rightPaneBg p-4")},[t]);return e.current?(0,n.jsx)(th,{children:(0,n.jsx)(M,{children:(0,n.jsxs)("div",{className:"h-screen flex flex-col bg-black relative",children:[(0,n.jsxs)("div",{className:"flex flex-1",children:[(0,n.jsx)("div",{className:v.leftPane,children:(0,n.jsx)(tu,{})}),(0,n.jsx)(l(),{axis:"x",onDrag:g,position:{x:0,y:0},handle:".handle",bounds:"parent",children:(0,n.jsx)("div",{className:"handle w-1 bg-leftPaneBg h-full cursor-col-resize transition-all duration-200 flex items-center justify-center",children:(0,n.jsx)("div",{className:"rounded-full w-3 bg-gray-600 h-40 transition-all duration-200 hover:bg-gray-500"})})}),(0,n.jsx)("div",{className:v.rightPane,children:(0,n.jsx)(P,{view:r})})]}),(0,n.jsx)("div",{className:"w-full h-16 bg-black flex items-center justify-center",children:(0,n.jsx)(B,{setRightView:f,toggleAppMenu:h,toggleSettings:p})}),s&&(0,n.jsx)(U,{currentViewMode:t,toggleViewMode:m,handleSetRightView:f,toggleFullscreen:x,setShowAppMenu:c})]})})}):(0,n.jsx)("div",{className:"h-screen bg-black flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-pulse text-white",children:"Loading..."})})}}},function(e){e.O(0,[689,870,676,918,875,971,117,744],function(){return e(e.s=7343)}),_N_E=e.O()}]);