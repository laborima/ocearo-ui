(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{87343:function(e,t,a){Promise.resolve().then(a.bind(a,99670))},53082:function(e,t,a){"use strict";a.d(t,{$:function(){return M},FV:function(){return d},G5:function(){return b},HH:function(){return u},HQ:function(){return w},NU:function(){return x},Qj:function(){return p},Ux:function(){return m},YH:function(){return C},eF:function(){return g},gK:function(){return c},n5:function(){return f},vd:function(){return h},yC:function(){return T}});var n=a(57437),i=a(2265),r=a(14578),l=a(63321),o=a(72079);let s=(0,i.createContext)(),c="#09bfff",u="#cc000c",d="#0fcd4f",g="#ef4444",h="#989898",f="#424242",m=e=>null==e?null:Math.round((180*e/Math.PI+360)%360),p=e=>null==e?null:(e*v).toFixed(1),v=1.94384,b=e=>null!=e?Math.round((e-273.15)*10)/10:null,w=e=>null!=e?Math.round(19.4384*e)/10:null,M=w,x=e=>null!=e?Math.round(e/100*10)/10:null,y={autopilot:!0,anchorWatch:!1,parkingMode:!1,mob:!1,showOcean:!1,ais:!1,showPolar:!0},S={wind:{"environment.wind.angleTrueWater":o.M8C.degToRad(0),"environment.wind.speedTrue":10.288,"environment.wind.angleApparent":o.M8C.degToRad(0),"environment.wind.speedApparent":10.288},temperature:{"environment.water.temperature":290.15,"environment.outside.temperature":294.15,"propulsion.main.exhaustTemperature":368.15,"environment.inside.fridge.temperature":277.15},environment:{"environment.outside.pressure":102300,"environment.inside.relativeHumidity":.74,"environment.inside.voc":.03},performance:{"performance.beatAngle":o.M8C.degToRad(45),"performance.gybeAngle":o.M8C.degToRad(135),"performance.beatAngleVelocityMadeGood":6,"performance.gybeAngleVelocityMadeGood":5,"performance.targetAngle":o.M8C.degToRad(45),"performance.polarSpeed":8,"performance.polarSpeedRatio":.95,"performance.velocityMadeGood":5,"performance.polarVelocityMadeGood":6,"performance.polarVelocityMadeGoodRatio":.9},navigation:{"navigation.speedThroughWater":7,"navigation.headingTrue":o.M8C.degToRad(0),"navigation.courseOverGround":o.M8C.degToRad(20),"navigation.courseGreatCircle.nextPoint.bearingTrue":o.M8C.degToRad(30),"navigation.attitude":{roll:o.M8C.degToRad(5),pitch:o.M8C.degToRad(2),yaw:o.M8C.degToRad(2)}},racing:{"navigation.racing.layline":o.M8C.degToRad(10),"navigation.racing.layline.distance":100,"navigation.racing.layline.time":180,"navigation.racing.oppositeLayline":o.M8C.degToRad(45),"navigation.racing.oppositeLayline.distance":80,"navigation.racing.oppositeLayline.time":180,"navigation.racing.startLineStb":{latitude:0,longitude:0,altitude:0},"navigation.racing.startLinePort":{latitude:0,longitude:0,altitude:0},"navigation.racing.distanceStartline":50,"navigation.racing.timeToStart":120,"navigation.racing.timePortDown":60,"navigation.racing.timePortUp":70,"navigation.racing.timeStbdDown":65,"navigation.racing.timeStbdUp":75},electrical:{"electrical.batteries.1.name":"House Battery","electrical.batteries.1.location":"Under Starboard Bed","electrical.batteries.1.capacity.nominal":768,"electrical.batteries.1.capacity.actual":707,"electrical.batteries.1.capacity.remaining":601,"electrical.batteries.1.capacity.dischargeLimit":.2,"electrical.batteries.1.capacity.timeRemaining":9860,"electrical.batteries.1.lifetimeDischarge":54e4,"electrical.batteries.1.lifetimeRecharge":545e3,"electrical.batteries.1.voltage.ripple":.05,"electrical.batteries.1.chemistry":"LeadAcid","electrical.batteries.1.manufacturer.name":"VARTA","electrical.batteries.1.manufacturer.model":"Professional Dual Purpose RA 595 985","electrical.batteries.1.manufacturer.URL":"https://www.varta-automotive.com","electrical.batteries.1.dateInstalled":"2020-06-15T00:00:00Z","electrical.batteries.1.associatedBus":"House Bus","electrical.batteries.0.name":"Engine Start Battery","electrical.batteries.0.location":"Engine Compartment","electrical.batteries.0.capacity.nominal":888,"electrical.batteries.0.capacity.actual":861,"electrical.batteries.0.chemistry":"LeadAcid","electrical.batteries.0.manufacturer.name":"VARTA","electrical.batteries.0.manufacturer.model":"Blue Dynamic E11","electrical.batteries.0.manufacturer.URL":"https://www.varta-automotive.com","electrical.batteries.0.dateInstalled":"2022-04-10T00:00:00Z","electrical.batteries.0.associatedBus":"Start Bus","navigation.lights":!1,"steering.autopilot.state":"auto"}},C=e=>{let{children:t}=e,[a,c]=(0,i.useState)({}),[u,d]=(0,i.useState)(!1),[g,h]=(0,i.useState)(y),f=e=>a[e]||null,m=(0,i.useRef)(null),p=(0,i.useRef)(null);return(0,i.useEffect)(()=>{let e=!0,t=async()=>{let e=new Date,t=e.getFullYear(),a=(e.getMonth()+1).toString().padStart(2,"0"),n="tides/larochelle/".concat(a,"_").concat(t,".json"),i=await fetch(n);if(i.ok){let t=await i.json(),a=e.toISOString().split("T")[0];if(t[a]){let e=null,n=null,i=new Date,r=60*i.getHours()+i.getMinutes();if(t[a].forEach(t=>{let[a,i,l,o]=t,[s,c]=i.split(":").map(Number),u=60*s+c;"tide.high"===a&&(!e||Math.abs(r-u)<Math.abs(r-e.timeInMinutes))?e={height:parseFloat(l),time:i,timeInMinutes:u,coef:o}:"tide.low"===a&&(!n||Math.abs(r-u)<Math.abs(r-n.timeInMinutes))&&(n={height:parseFloat(l),time:i,timeInMinutes:u})}),e&&n){let t="".concat(i.getHours().toString().padStart(2,"0"),":").concat(i.getMinutes().toString().padStart(2,"0")),a=P(e.height,n.height,t,e.time,n.time);c(t=>({...t,"environment.tide.heightNow":a,"environment.tide.heightHigh":e.height,"environment.tide.heightLow":n.height,"environment.tide.timeLow":n.time,"environment.tide.timeHigh":e.time,"environment.tide.coeffNow":e.coef}))}else throw Error("Tide data for today is incomplete.")}}else console.warn("No tide data found")};return(async()=>{let{signalkUrl:t,debugMode:a}=l.Z.getAll(),n=()=>{p.current&&clearInterval(p.current);let e=0;p.current=setInterval(()=>{let t=Math.floor(91*Math.random())-45;e=(e+5)%360,c(e=>({...e,"steering.rudderAngle":o.M8C.degToRad(t),...S.temperature,...S.environment,...S.performance,...S.navigation,...S.racing,...S.electrical}))},1e3)};try{let[i,l]=t.replace(/https?:\/\//,"").split(":"),o=new r.default({hostname:i||"localhost",port:parseInt(l)||3e3,useTLS:t.startsWith("https"),reconnect:!0,autoConnect:!1,notifications:!1,deltaStreamBehaviour:"self",sendMeta:"all",wsKeepaliveInterval:10});m.current=o,await o.connect(),o.on("delta",t=>{e&&t.updates.forEach(e=>{e.values&&e.values.forEach(e=>{c(t=>({...t,[e.path]:e.value}))})})}),a&&n()}catch(e){console.error("Failed to connect to SignalK:",e),n()}})(),t(),()=>{e=!1,m.current&&m.current.disconnect(),p.current&&clearInterval(p.current)}},[]),(0,n.jsx)(s.Provider,{value:{getSignalKValue:f,getBoatRotationAngle:()=>{let e=f("navigation.headingTrue")||f("navigation.headingMagnetic");return f("navigation.courseOverGroundTrue")||f("navigation.courseOverGroundMagnetic")||e||0},convertLatLonToXY:(e,t)=>{if(!(null==e?void 0:e.lat)||!(null==e?void 0:e.lon)||!(null==t?void 0:t.lat)||!(null==t?void 0:t.lon))return console.warn("Invalid input to convertLatLonToXY",e,t),{x:0,y:0};let a=t.lat*Math.PI/180,n=t.lon*Math.PI/180,i=e.lat*Math.PI/180,r=e.lon*Math.PI/180-n,l=i-a,o=Math.atan2(Math.sin(r)*Math.cos(i),Math.cos(a)*Math.sin(i)-Math.sin(a)*Math.cos(i)*Math.cos(r)),s=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(i)*Math.sin(r/2)*Math.sin(r/2),c=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371e3;return{x:c*Math.sin(o),y:c*Math.cos(o)}},nightMode:u,setNightMode:d,states:g,toggleState:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;h(a=>({...a,[e]:void 0!==t?t:!a[e]}))}},children:t})},T=()=>(0,i.useContext)(s),P=function(e,t,a,n,i){let r,l,o,s;if(!a||!n||!i||!/^\d{1,2}:\d{2}$/.test(a)||!/^\d{1,2}:\d{2}$/.test(n)||!/^\d{1,2}:\d{2}$/.test(i))return console.error("Invalid time format provided to calculateTideHeightUsingTwelfths"),(e+t)/2;let c=e=>{let[t,a]=e.split(":").map(Number);return 60*t+a},u=c(n),d=c(i),g=c(a),h=!1;d<=g&&g<=u?(h=!0,r=t,l=e,o=d,s=u):(r=e,l=t,o=u,s=d+(d<u?1440:0));let f=Math.abs(s-o),m=Math.abs(l-r),p=g-o;p<0&&(p+=1440);let v=m/12,b=0;return b=p<=f/6?v*Math.ceil(p/(f/12)):p<=2*f/6?2*v+v*Math.ceil((p-f/6)/(f/12)):p<=3*f/6?5*v:p<=4*f/6?8*v:p<=5*f/6?10*v:m,h?r+b:r-b}},63321:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var n=JSON.parse('{"F":[{"name":"Default","modelPath":"default","capabilities":["navigation","rudder","sail","color"]},{"name":"Optimist","modelPath":"optimist","capabilities":["navigation","ais"]},{"name":"Sailboat","modelPath":"sailboat","capabilities":["navigation","ais"]},{"name":"Ship","modelPath":"ship","capabilities":["navigation","ais"]},{"name":"Windsurf","modelPath":"windsurf","capabilities":["navigation","ais"]}]}');class i{isLocalStorageAvailable(){try{return"undefined"!=typeof localStorage}catch(e){return!1}}loadConfig(){if(this.isLocalStorageAvailable()){let e=localStorage.getItem(this.configKey);if(!e)return this.saveConfig(this.defaultConfig),{...this.defaultConfig};try{return JSON.parse(e)}catch(e){return console.error("Failed to parse stored configuration:",e),{...this.defaultConfig}}}return{...this.inMemoryConfig}}saveConfig(e){this.config={...this.config,...e},this.isLocalStorageAvailable()?localStorage.setItem(this.configKey,JSON.stringify(this.config)):this.inMemoryConfig={...this.config}}get(e){return this.config[e]}set(e,t){this.config[e]=t,this.saveConfig(this.config)}resetConfig(){this.config={...this.defaultConfig},this.isLocalStorageAvailable()?localStorage.setItem(this.configKey,JSON.stringify(this.config)):this.inMemoryConfig={...this.defaultConfig}}getAll(){return{...this.config}}getDefaultConfig(){return{...this.defaultConfig}}getSelectedBoat(){let e=this.config.selectedBoat;return e?this.getBoatsData().find(t=>t.name===e):[]}getBoatsData(){return n.F}getComputedSignalKUrl(){return this.config.debugMode?"https://demo.signalk.org:443":"".concat(window.location.protocol,"//").concat(window.location.hostname).concat(window.location.port?":"+window.location.port:"")}constructor(){this.defaultConfig={signalkUrl:"http://localhost:3000",username:"",password:"",debugMode:!1,selectedBoat:"Default",primaryColor:null,metallicEffect:!1,aisLengthScalingFactor:.7,compassNorthUp:!1,showCustomUrls:!1,customExternalUrls:{}},this.configKey="ocearoConfig",this.inMemoryConfig={...this.defaultConfig},this.config=this.loadConfig()}}var r=new i},99670:function(e,t,a){"use strict";a.r(t),a.d(t,{VIEW_MODES:function(){return f},default:function(){return p}});var n=a(57437),i=a(2265),r=a(30166),l=a(20376),o=a.n(l),s=a(53082);class c extends i.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t}),console.error("Error caught in Error Boundary:",e,t)}render(){if(this.state.hasError){let{error:e,errorInfo:t}=this.state;return(0,n.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-100 text-gray-900",children:[(0,n.jsx)("h1",{className:"text-3xl font-bold text-red-600 mb-4",children:"Something went wrong."}),(0,n.jsxs)("p",{className:"text-lg mb-2",children:[(0,n.jsx)("strong",{children:"Error:"})," ",e?e.toString():"Unknown error"]}),t&&(0,n.jsxs)("details",{className:"whitespace-pre-wrap bg-gray-200 p-4 rounded-lg mb-4",children:[(0,n.jsx)("summary",{className:"cursor-pointer text-blue-500 underline",children:"Stack Trace"}),(0,n.jsx)("pre",{className:"mt-2",children:t.componentStack})]}),(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)("button",{onClick:this.handleRefresh,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600",children:"Refresh Page"}),(0,n.jsx)("button",{onClick:this.handleExitFullscreen,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Exit Fullscreen"})]})]})}return this.props.children}constructor(e){super(e),this.handleRefresh=()=>{window.location.reload()},this.handleExitFullscreen=()=>{document.fullscreenElement&&(window.close(),document.exitFullscreen().catch(e=>{console.error("Failed to exit fullscreen:",e)}))},this.state={hasError:!1,error:null,errorInfo:null}}}let u=(0,r.default)(()=>a.e(252).then(a.bind(a,7252)),{loadableGenerated:{webpack:()=>[7252]},loading:()=>(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:"Loading..."})}),d=(0,r.default)(()=>Promise.all([a.e(676),a.e(268),a.e(12)]).then(a.bind(a,12012)),{loadableGenerated:{webpack:()=>[12012]}}),g=(0,r.default)(()=>Promise.all([a.e(676),a.e(268),a.e(936)]).then(a.bind(a,72936)),{loadableGenerated:{webpack:()=>[72936]}}),h=(0,r.default)(()=>Promise.all([a.e(676),a.e(689),a.e(268),a.e(496),a.e(412)]).then(a.bind(a,6412)),{loadableGenerated:{webpack:()=>[6412]},loading:()=>(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,n.jsx)("div",{className:"text-white text-2xl",children:"Loading 3D View..."})}),ssr:!1}),f={BOAT:"boat",APP:"app",SPLIT:"split"},m=()=>window.innerWidth>=1366;function p(){let e=(0,i.useRef)(!1),[t,a]=(0,i.useState)(null),[r,l]=(0,i.useState)("navigation"),[p,v]=(0,i.useState)(!1),[b,w]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let t;a(m()?f.SPLIT:f.BOAT),e.current=!0;let n=()=>{clearTimeout(t),t=setTimeout(()=>{a(m()?f.SPLIT:f.BOAT)},250)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),clearTimeout(t)}},[]);let M=(0,i.useCallback)(()=>{v(e=>!e)},[]),x=(0,i.useCallback)(e=>{a(e)},[]),y=(0,i.useCallback)((e,t)=>{let a=window.innerWidth/5;t.x>a?x(f.BOAT):t.x<-a?x(f.APP):x(f.SPLIT)},[x]),S=(0,i.useCallback)(()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen().catch(e=>{console.error("Fullscreen error:",e.message)})},[]),C=(0,i.useCallback)(e=>{t===f.BOAT&&x(f.APP),l(e)},[t,x]),T=(0,i.useCallback)(()=>{b?(x(f.BOAT),w(!1)):(C("settings"),w(!0))},[b,x,C]),P=(0,i.useMemo)(()=>null===t?{}:{leftPane:"transition-all duration-300 ".concat(t===f.BOAT?"w-full":t===f.APP?"hidden":"w-2/5"," bg-leftPaneBg h-full relative"),rightPane:"transition-all duration-300 ".concat(t===f.APP?"w-full":t===f.BOAT?"hidden":"w-3/5"," h-full bg-rightPaneBg p-4")},[t]);return e.current?(0,n.jsx)(c,{children:(0,n.jsx)(s.YH,{children:(0,n.jsxs)("div",{className:"h-screen flex flex-col bg-black relative overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex flex-1 min-h-0",children:[(0,n.jsx)("div",{className:P.leftPane,children:(0,n.jsx)(h,{})}),(0,n.jsx)(o(),{axis:"x",onDrag:y,position:{x:0,y:0},handle:".handle",bounds:"parent",children:(0,n.jsx)("div",{className:"handle w-1 bg-leftPaneBg h-full cursor-col-resize transition-all duration-200 flex items-center justify-center",children:(0,n.jsx)("div",{className:"rounded-full w-3 bg-gray-600 h-40 transition-all duration-200 hover:bg-gray-500"})})}),(0,n.jsx)("div",{className:P.rightPane,children:(0,n.jsx)(u,{view:r})})]}),(0,n.jsx)("div",{className:"w-full h-16 min-h-16 bg-black flex items-center justify-center shrink-0",children:(0,n.jsx)(d,{setRightView:C,toggleAppMenu:M,toggleSettings:T})}),p&&(0,n.jsx)(g,{currentViewMode:t,toggleViewMode:x,handleSetRightView:C,toggleFullscreen:S,setShowAppMenu:v})]})})}):(0,n.jsx)("div",{className:"h-screen bg-black flex items-center justify-center",children:(0,n.jsx)("div",{className:"animate-pulse text-white",children:"Loading..."})})}}},function(e){e.O(0,[870,746,971,117,744],function(){return e(e.s=87343)}),_N_E=e.O()}]);